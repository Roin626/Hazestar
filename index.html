<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/html">

	<head>
		<meta charset="utf-8" />

		<meta name="viewport"
			  content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<!-- 设置初始缩放比例为1.0，使用设备宽度  -->
		<!-- 在iOS下开启全屏模式  -->
		<meta name="apple-mobile-web-app-capable" content="yes">
		<!-- 隐藏 Sarafi 状态栏  -->
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<title>岚星历险记</title>
		<link href="alert.css">
		<style>
		* {
		  box-sizing: border-box;
		}
		html{
			margin:0;
			min-height:978px; height:auto !important;height:978px;
		}

		body {
			height: 100%;
			min-width: 100%;
			min-height: 978px;
			margin:0;
		  	font-family: Arial;
		  	padding: 10px;
		  	background: #f1f1f1;
		}
		.wrapper {
			height: 100%;
			width: 100%;
			min-width: 100%;
			min-height:100%;
			/*position:relative;*/
    		/*box-sizing: border-box;*/
		}
		.mainContainer{
			padding-top: 10px;
			padding-bottom: 20px;
			min-height:978px;
			width: 100%;
			height: 100%;
			position:relative;
			padding-bottom: 200px;
			font-size: smaller;
		}

		/* 头部标题 */
		.header {
			font-size: x-small;
			padding: 5px;
			height: 10%;
			border-radius: 25px;
			background-color: #f1f1f1;
		}

		.header h1 {
		  font-size: 50px;
		}

		/* 导航条 */
		.topnav {
		  	overflow: hidden;
		  	background-color: #f1f1f1;
			height: 10%;
			text-align: center;
		  	/*background: white;*/
			border-radius: 25px;
		}

		/* 导航条链接 */
		.topnav a {
		  float: left;
		  display: block;
		  color: #f2f2f2;
		  text-align: center;
		  padding: 14px 16px;
		  text-decoration: none;
		}

		/* 链接颜色修改 */
		.topnav a:hover {
		  background-color: #ddd;
		  color: black;
		}

		/* 创建两列 */
		/* Left column */
		.leftcolumn {

		  	float: left;
		  	width: 33%;
			padding: 5px;
		}
		.midcolumn {
		  	float: left;
			height: 100%;
		  	width: 33%;
			padding: 5px;
		}

		/* 右侧栏 */
		.rightcolumn {
		  	float: left;
		  	width: 33%;
			padding: 5px;
		}

		/* 图像部分 */
		.fakeimg {
		  background-color: #aaa;
		  width: 100%;
		  padding: 20px;
		}
		.character{
			max-width: 100%;
			min-width: 100%;
			display:inline-block;
			-webkit-transition-duration: 0.4s;
			transition-duration: 0.4s;
			padding: 5px 5px;
			text-align: center;
			background-color: white;
			color: #000000;
			border: 2px solid;
			border-color: #adeeaf;
			border-radius:10px;
			margin: 2px;

		}

		/* 文章卡片效果 */
		.card {
		  /*background-color: white;*/
		  	padding: 10px;
			border-radius: 25px;
			font-size: x-small;
		}
		/*整个中间列的属性*/
		.row{
			height: 65%;
			width: auto;
			margin-bottom: 2%;
		}
		/* 列后面清除浮动 */
		.row:after {
		  content: "";
		  display: table;
		  clear: both;
		}
		.ptxt{
			font-size: x-small;
			margin: 0 0 0.5em 0;
		}

		/* 底部 */
		.footer {

		  	padding: 5px;
			height: 12%;
			max-height: 200px;
			width: 100%;
			position:absolute;
    		bottom:0px;
    		left:0px;
		 	text-align: center;
		  	background: #ddd;
		  	margin-top: 2%;

			border-radius: 25px;
		}
		.PopupWindow {
			-webkit-transition-duration: 0.4s;
			transition-duration: 0.4s;
			text-align: center;
			color: #000000;
			margin: 5px;
			padding: 5px;
			position:absolute;
			z-index: 1;
			background: aliceblue;
			border-radius: 15px;
			box-shadow: 0 0 10px #d5d5d5;
			font-size: 10px;
		}
		/* 按钮 */
		 .button_fail {
			 font-size: x-small;
			 -webkit-transition-duration: 0.4s;
			 transition-duration: 0.4s;
			 padding: 5px 10px;
			 text-align: center;
			 background-color: #959595;
			 color: #fffefe;
			 border: 2px solid #adeeaf;
			 border-radius:5px;
			 margin: 5px;
			 }
			 .button_fail:hover {
			 background-color: #c1c1c1;
			 color: white;
			 }
			 .button_fail:active{
			 	background-color: #9e9e9e;
			 	color: white;
			 }

		.button1 {
			font-size: x-small;
			 -webkit-transition-duration: 0.4s;
			 transition-duration: 0.4s;
			 padding: 5px 10px;
			 text-align: center;
			 background-color: white;
			 color: #000000;
			 border: 2px solid #adeeaf;
			 border-radius:5px;
			 margin: 5px;
			 }
			 .button1:hover {
			 background-color: #adeeaf;
			 color: white;
			 }
			 .button1:active{
			 	background-color: #61a163;
			 	color: white;
			 }
		.button_equip {
			-webkit-transition-duration: 0.4s;
			transition-duration: 0.4s;
			padding: 5px 10px;
			text-align: center;
			background-color: white;
			color: #000000;
			border: 5px solid;
			border-color: #adeeaf;
			border-radius:5px;
			margin: 5px;
			position:absolute;
			z-index: 1;
		}
			 .button_equip:hover {
				 background-color: #adeeaf;
				 color: white;
				 position: absolute;
				 z-index: 2;
			 }
			 .button_equip:active{
			 	background-color: #61a163;
			 	color: white;
			 }
		.button_equip_fax {
			-webkit-transition-duration: 0.4s;
			transition-duration: 0.4s;
			padding: 5px 10px;
			text-align: center;
			background-color: #959595;
			color: #fffefe;
			border: 5px solid;
			border-color: #adeeaf;
			border-radius:5px;
			margin: 5px;
			z-index: 0;
		}
		.button_equip_fail {
			-webkit-transition-duration: 0.4s;
			transition-duration: 0.4s;
			padding: 5px 10px;
			text-align: center;
			background-color: #959595;
			color: #fffefe;
			border: 5px solid;
			border-color: #adeeaf;
			border-radius:5px;
			margin: 5px;
			position:absolute;
			z-index: 1;
		}
			.button_equip_fail:hover {
				background-color: #c1c1c1;
			 	color: white;
				 position: absolute;
				 z-index: 2;
			}
			.button_equip_fail:active{
			 	background-color: #9e9e9e;
			 	color: white;
			}

		.button2 {
			 -webkit-transition-duration: 0.4s;
			 transition-duration: 0.4s;
			 padding: 5px 10px;
			 text-align: center;
			 background-color: white;
			 color: black;
			 border: 2px solid #eebfad;
			 border-radius:5px;
			font-size: x-small;
			margin: 5px;
			 }
			 .button2:hover {
			 background-color: #eebfad;
			 color: white;
			 }
			 .button2:active{
			 	background-color: #d0ac9e;
			 	color: white;
			 }

			 .collect_txt{
				 margin-top: 0px;
				 margin-bottom: 0px;
			 }
		.hideSlow{
			  animation: hidetip 10s 1;
			  animation-fill-mode: forwards;
			  -webkit-animation-fill-mode: forwards;
		}

		@keyframes hidetip {
			  from {
				opcity: 1;
			  }
			  to {
				opacity: 0;
			  }
			}
			@-webkit-keyframes hidetip {
			  from {
				opcity: 1;
			  }
			  to {
				opacity: 0;
			  }
			}
		/* 弹出框最外层 */
        .msg__wrap {
			position: fixed;
			top: 50%;
			left: 50%;
			z-index: 10;
			transition: all .3s;
			transform: translate(-50%, -50%) scale(0, 0);
			max-width: 50%;
			min-width: 220px;

			min-height: 190px;


        background: aliceblue;
        border-radius: 15px;
        box-shadow: 0 0 10px #d5d5d5;
        font-size: 10px;
      }

      /* 弹出框头部 */
        .msg__wrap .msg-header {
        	padding: 10px 10px 10px 10px;
			margin-left: 10px;
        	font-size: large;
			height: 25%;
			min-height: 45px;
      }

        .msg__wrap .msg-header .msg-header-close-button {
        float: right;
        cursor: pointer;
      }

      /* 弹出框中部 */
        .msg__wrap .msg-body {
        	padding: 10px 10px 10px 10px;
			height: 50%;
			min-height: 100px;
      }

      /* 图标 */
        .msg__wrap .msg-body .msg-body-icon{
        	width: 80px;
      }

        .msg__wrap .msg-body .msg-body-icon div{
        width: 45px;
        height: 45px;
        margin: 0 auto;
        line-height: 45px;
        color: #fff;
        border-radius: 50% 50%;
        font-size: small;
      }

        .msg__wrap .msg-body .msg-body-icon .msg-body-icon-success{
        background: #32a323;
        text-align: center;
      }

        .msg__wrap .msg-body .msg-body-icon .msg-body-icon-success::after{
        content: "成";
      }

        .msg__wrap .msg-body .msg-body-icon .msg-body-icon-wrong{
        background: #ff8080;
        text-align: center;
      }

        .msg__wrap .msg-body .msg-body-icon .msg-body-icon-wrong::after{
        content: "误";
      }

        .msg__wrap .msg-body .msg-body-icon .msg-body-icon-info{
        background: #80b7ff;
        text-align: center;
      }

        .msg__wrap .msg-body .msg-body-icon .msg-body-icon-info::after{
        content: "注";
      }

      /* 内容 */

        .msg__wrap .msg-body .msg-body-content{
        min-width: 80%;
        font-size: xx-small;
        word-break: break-all;
        align-items: center;
        padding-left: 10px;
        box-sizing: border-box;
      }

      /* 弹出框底部 */

        .msg__wrap .msg-footer {
        	padding: 0 10px 10px 10px;
          	height: 24%;
			min-height: 45px;
        	display: flex;
        	flex-direction: row-reverse;
      }

        .msg__wrap .msg-footer .msg-footer-btn {
          width: 25%;
			min-width: 70px;
          height: 30px;
          padding: 5px 10px;
          text-align: center;
          background-color: white;
          color: #000000;
          border: 2px solid #adeeaf;
          border-radius:5px;
          margin: 5px;
        }
        .msg__wrap .msg-footer .msg-footer-confirm-button {
            width: 48px;
            height: 30px;
			 -webkit-transition-duration: 0.4s;
			 transition-duration: 0.4s;
			 padding: 5px 10px;
			 text-align: center;
			 background-color: white;
			 color: #000000;
			 border: 2px solid #adeeaf;
			 border-radius:5px;
			 margin: 5px;
			 }
            .msg__wrap .msg-footer .msg-footer-confirm-button:hover {
			 background-color: #adeeaf;
			 color: white;
			 }
            .msg__wrap .msg-footer .msg-footer-confirm-button:active{
			 	background-color: #61a163;
			 	color: white;
			 }
        .msg__wrap .msg-footer .msg-footer-cancel-button {
            width: 48px;
            height: 30px;
            -webkit-transition-duration: 0.4s;
            transition-duration: 0.4s;
            padding: 5px 10px;
            text-align: center;
            background-color: white;
            color: black;
            border: 2px solid #eebfad;
            border-radius:5px;
        }
            .msg__wrap .msg-footer .msg-footer-cancel-button:hover {
			 background-color: #eebfad;
			 color: white;
			 }
            .msg__wrap .msg-footer .msg-footer-cancel-button:active{
			 	background-color: #d0ac9e;
			 	color: white;
			 }

      /* 遮罩层 */
        .msg__overlay {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        z-index: 5;
        background-color: rgba(173, 172, 172, 0.4);
        transition: all .3s;
        opacity: 0;
      }


		/* 响应式布局 - 屏幕尺寸小于 800px 时，两列布局改为上下布局 */
		@media screen and (max-width: 800px) {
		  .leftcolumn, .midcolumn, .rightcolumn {
			width: 100%;
			padding: 0;
		  }
		}

		/* 响应式布局 -屏幕尺寸小于 400px 时，导航等布局改为上下布局 */
		@media screen and (max-width: 400px) {
		  .topnav a {
			float: none;
			width: 100%;
		  }
		}
		</style>

		<script type="text/javascript">

		//*					工具包 						*//
		// 工具，隐藏层
		function hideLayer(id) {
		var obj = document.getElementById(id);
		obj.style.display = "none";
		}
		//显示层
		function showLayer(id) {
		var obj = document.getElementById(id);
		obj.style.display = "";
		}

		//文本档案记录
		var li_num=0;
		function writeLogOl(){
			var logStr = '·';
			for (var i = 0; i < arguments.length; i++) {
				logStr += arguments[i];
			}

			var logOl=document.getElementById("logol");
			var li=document.createElement("li");
			li.innerHTML=logStr;
			li_num++;
			li.id="logol1"+li_num;
			if (li_num>50){
				li_id=li_num-50;
				var kill1_id = "logol1" + li_id;
				var obj=document.getElementById(kill1_id);
				obj.remove();
			}
			logOl.appendChild(li);
			//获取log栏id，滚动条始终在最下
			var div = document.getElementById('logol');
			div.scrollTop = div.scrollHeight;
		}

		//文本档案记录
		var li2_num=0;
		function writeLogOl02(arguments,color){
			var logStr = '·';
			for (var i = 0; i < arguments.length; i++) {
				logStr += arguments[i];
			}

			var logOl=document.getElementById("logol02");
			var li=document.createElement("li");
			if (color!=null){
				li.style.color=color
			}else {
				li.style.color= "#000000"
			}

			li.innerHTML=logStr;
			li.className="hideSlow"

			li2_num++;
			li.id="logol2"+li2_num;
			if (li2_num>20){
				li2_id=li2_num-20;
				var kill2_id = "logol2" + li2_id;
				var obj=document.getElementById(kill2_id);
				obj.remove();
			}

			logOl.appendChild(li);

			//获取log栏id，滚动条始终在最下
			var div = document.getElementById('logol02');
			div.scrollTop = div.scrollHeight;
		}
		// function writeLogOl02(){
		// 	var logStr02 = '·';
		// 	for (var i02 = 0; i02 < arguments.length; i02++) {
		// 		logStr02 += arguments[i02];
		// 	}
		//
		// 	var logOl02=document.getElementById("logol02");
		// 	var li02=document.createElement("li02");
		// 	li02.innerHTML=logStr02;
		// 	logOl02.appendChild(li02);
		// 	//获取log栏id，滚动条始终在最下
		// 	var div02 = document.getElementById('logol02');
		// 	div02.scrollTop = div02.scrollHeight;
		// }

		function num_change (num){

			//个位
			var a = parseInt(num%10);
			//十位
			var b = parseInt(num/10 % 10);
			//百位
			var c = parseInt(num/100 % 10);
			//千
			var d = parseInt(num/1000 % 10);
			//万
			var e = parseInt(num/10000 % 10);
			//十万
			var f = parseInt(num/100000 % 10);
			//百万
			var g = parseInt(num/1000000 % 10);
			//千万
			var h = parseInt(num/10000000 % 10);
			//亿
			var i = parseInt(num/100000000 % 10);
			//十亿
			var j = parseInt(num/1000000000 % 10);
			if (num>1000000000){
				var E=parseInt(num/100000000);
				var numshow= E+"."+h+g+"E";
			}else if(num>1000000){
				var M=parseInt(num/1000000);
				var numshow= M+"."+f+e+"M";
			}else if(num>1000){
				var K=parseInt(num/1000);

				var numshow= K+"."+c+b+"K";
			}else {
				numshow=num;
			}



		return numshow
		}

		</script>
	</head>

	<body bgcolor="#00baff" onload="csh_()">
	<!--	调用函数		-->
	<script src="alart.js"></script>
	<script src="maoqiu.js"></script>
	<script src="meiqiu.js"></script>
	<script src="Yourdata.js"></script>

	<div class="mainContainer" style="font-size: small ">
		<div class="header">
			<p style="font-size: xx-small;display: inline-block">游戏作者：凌霜雪猫</p>
			<button class="button1" id="help" style=" display: inline-block" onclick=Help()>
				游戏说明
			</button>
			<p style="font-size: xx-small">背景故事《星体意识》作者:风翎空羽</p>
			<p style="font-size: xx-small">因为飞船燃料耗尽，你落难于未知的星球，幸好你发现了岚星晶矿，可以挖岚星晶矿来重新修建飞船</p>

		</div>

		<HR width="100%"color=#66ccff SIZE=10>

		<script type="text/javascript"> //标记以下代码为javascript

		//-----------背景颜色选取-------------//
		if (Math.round(Math.random()*10) >= 5){//冰雪星球颜色 aliceblue

			new $Msg({
				title:"欢迎加入游戏",
				content: "故障...故障...紧急降落!\n一个陌生的星球...是冰面?"
			})

			document.body.style.backgroundColor ="#F0F8FF";
			}
		else{//岩石星球颜色c1a68a

			new $Msg({
				title:"欢迎加入游戏",
				content: "故障...故障...紧急降落!\n一个陌生的星球...是岩石星球?"
			})
			document.body.style.backgroundColor ="#fdedd1";
			}

		//-----------下面是游戏逻辑的代码-------------//
		// <!--												 -->
		// <!--					初始参数						 -->
		// <!--												 -->
		var tanxian_flag=0;

		var maoqiu_time=500;	//maoqiu的进入值
		var maoqiu_health_fix=400; //maoqiu固定起始血量

		var maoqiu_attach_fix=10;
		var maoqiu_defend_fix=10;
		var maoqiu_speed_fix=10;
		var maoqiu_crit_fix = 0;

		var dayboss_victory=0;
		var dayboss_flag=0;
		var maoqiu_flag=0;
		var meiqiu_flag=0;
		var coal=0;
		var coal_total=0;
		var space_metal=0;
		var space_metal_total=0;

		var meiqiu_data={meiqiu_name:"煤球",meiqiu_health:100, meiqiu_attach:0, meiqiu_defend:0, meiqiu_speed:0, meiqiu_crit:0}
		var maoqiudata={name:"毛球",health:500,health_total:500,
            attach:0,defend:0,
            speed:0,crit:0}

		var PR_meiqiu=0.99; //煤球的自动出现概率
		var meiqiu_time=1000; //自动煤球的起始时间

		var maoqiu_name="毛球"; //毛球名字
		var game_space_choose=0; //是否进行了星空阶段
		var Critical_hit_level=1.25;//暴击等级 暴击倍率
		var equip1=1;
		var equip2=0;

		var ship_name = "普通飞船"
		var gun_names=["火药弹弓","弓弩机关","牵绳排枪","自动机关炮","RPG!","等离子点火机","电子密集阵","激光近防炮"];
		var shield_names=["柚木装甲","铁皮装甲","钢板装甲","防爆装甲","毛球反应装甲","电磁偏折护盾","等离子护盾","超合金装甲"];
		var engine_names=["仓鼠轮","燃煤锅炉","柴油轮机","脉冲震爆发动机","液氧煤油火箭","液氧煤油火箭","裂变冲击飞行系统","光压飞行系统","自给养氢聚变发动机"];
		var equip_names=["战机","飞盘","飞剑","战甲","浮游炮","舰娘","飞龙","徙星鸟"];


		 //初始化
 		function csh_(){
 			if(typeof(localStorage.ship_name) == "undefined") { localStorage.ship_name=ship_name;  }//当前船名
			//采集系统
			if(typeof(localStorage.Upcore) == "undefined") { localStorage.Upcore=0;  }//当前升级核心
     		if(typeof(localStorage.Lv) == "undefined") { localStorage.Lv=0;  }//当前等级
     		if(typeof(localStorage.coal) == "undefined") { localStorage.coal=0; }//当前岚星晶矿
			if(typeof(localStorage.gain_station) == "undefined") { localStorage.gain_station=0; }//当前采集站
			if(typeof(localStorage.space_metal) == "undefined") { localStorage.space_metal=0; }//当前宇宙矿物
			if(typeof(localStorage.space_gain_station) == "undefined") { localStorage.space_gain_station=0; }//当前宇宙采集站
			if(typeof(localStorage.space_refine_station) == "undefined") { localStorage.space_refine_station=0; }//当前宇宙提炼站

			if(typeof(localStorage.xinglan_crystal) == "undefined") { localStorage.xinglan_crystal=0; }//当前星岚结晶、能力点
			if(typeof(localStorage.used_xinglan_crystal) == "undefined") { localStorage.used_xinglan_crystal=0; } //使用的星岚结晶

			if(typeof(localStorage.game_space_choose) == "undefined") { localStorage.game_space_choose=0; }//当前宇宙阶段
			if(typeof(localStorage.damaoxian) == "undefined") { localStorage.damaoxian=0; }//当前大冒险开启状态

			if(typeof(localStorage.dayboss_victory) == "undefined") { localStorage.dayboss_victory=dayboss_victory; }

     		//maoqiu系统
			if(typeof(localStorage.maoqiu_name) == "undefined") { localStorage.maoqiu_name=maoqiu_name; }
     		if(typeof(localStorage.maoqiu_flag) == "undefined") { localStorage.maoqiu_flag=0; }
     		if(typeof(localStorage.maoqiu_health) == "undefined") { localStorage.maoqiu_health=maoqiu_health_fix; }
			if(typeof(localStorage.maoqiu_attach) == "undefined") { localStorage.maoqiu_attach=maoqiu_attach_fix; }
     		if(typeof(localStorage.maoqiu_defend) == "undefined") { localStorage.maoqiu_defend=maoqiu_defend_fix; }
			if(typeof(localStorage.maoqiu_speed) == "undefined") { localStorage.maoqiu_speed=maoqiu_speed_fix; }
			if(typeof(localStorage.maoqiu_crit) == "undefined") { localStorage.maoqiu_crit=maoqiu_crit_fix; }

     		//小怪系统
			if(typeof(localStorage.meiqiu_name) == "undefined") { localStorage.meiqiu_name=meiqiu_data.meiqiu_name; }
			if(typeof(localStorage.meiqiu_flag) == "undefined") { localStorage.meiqiu_flag=0; }
			if(typeof(localStorage.meiqiu_health) == "undefined") { localStorage.meiqiu_health=meiqiu_data.meiqiu_health; }
			if(typeof(localStorage.meiqiu_attach) == "undefined") { localStorage.meiqiu_attach=meiqiu_data.meiqiu_attach; }
     		if(typeof(localStorage.meiqiu_defend) == "undefined") { localStorage.meiqiu_defend=meiqiu_data.meiqiu_defend; }
			if(typeof(localStorage.meiqiu_speed) == "undefined") { localStorage.meiqiu_speed=meiqiu_data.meiqiu_speed; }
			if(typeof(localStorage.meiqiu_crit) == "undefined") { localStorage.maoqiu_crit=meiqiu_data.meiqiu_crit; }

			//你属性
     		if(typeof(localStorage.xx_health) == "undefined") { localStorage.xx_health=50; }
     		if(typeof(localStorage.xx_health_total) == "undefined") { localStorage.xx_health_total=50; }
     		if(typeof(localStorage.skillpoint) == "undefined") {localStorage.skillpoint = 30};
     		if(typeof(localStorage.skillpoint_total) == "undefined") {localStorage.skillpoint_total = 30};
     		if(typeof(localStorage.xx_attach) == "undefined") { localStorage.xx_attach=0; }
     		if(typeof(localStorage.xx_defend) == "undefined") { localStorage.xx_defend=0; }
			if(typeof(localStorage.xx_speed) == "undefined") { localStorage.xx_speed=0; }
			if(typeof(localStorage.xx_crit) == "undefined") { localStorage.xx_crit=0; }
			//你装备
			if(typeof(localStorage.gun_name) == "undefined") { localStorage.gun_name="火药弹弓"; }
			if(typeof(localStorage.xx_guns) == "undefined") { localStorage.xx_guns=0; }
			if(typeof(localStorage.shield_name) == "undefined") { localStorage.shield_name="柚木装甲"; }
			if(typeof(localStorage.xx_shields) == "undefined") { localStorage.xx_shields=0; }
			if(typeof(localStorage.engine_name) == "undefined") { localStorage.engine_name="仓鼠轮"; }
			if(typeof(localStorage.xx_engines) == "undefined") { localStorage.xx_engines=0; }
			//装备卡
			if(typeof(localStorage.equip1_name) == "undefined") { localStorage.equip1_name="原始护卫"; }
			if(typeof(localStorage.equip1_type) == "undefined") { localStorage.equip1_type=0; }
			if(typeof(localStorage.equip1_level) == "undefined") { localStorage.equip1_level=0; }
			if(typeof(localStorage.equip1_att) == "undefined") { localStorage.equip1_att=0; }
			if(typeof(localStorage.equip1_def) == "undefined") { localStorage.equip1_def=0; }
			if(typeof(localStorage.equip1_speed) == "undefined") { localStorage.equip1_speed=0; }
			if(typeof(localStorage.equip1_crit) == "undefined") { localStorage.equip1_crit=0; }

			if(typeof(localStorage.equip2_name) == "undefined") { localStorage.equip2_name="原始护卫"; }
			if(typeof(localStorage.equip2_type) == "undefined") { localStorage.equip2_type=0; }
			if(typeof(localStorage.equip2_level) == "undefined") { localStorage.equip2_level=0; }
			if(typeof(localStorage.equip2_att) == "undefined") { localStorage.equip2_att=0; }
			if(typeof(localStorage.equip2_def) == "undefined") { localStorage.equip2_def=0; }
			if(typeof(localStorage.equip2_speed) == "undefined") { localStorage.equip2_speed=0; }
			if(typeof(localStorage.equip2_crit) == "undefined") { localStorage.equip2_crit=0; }

			if(typeof(localStorage.tongxunzhan) == "undefined") { localStorage.tongxunzhan=0; }//通讯站
			if(typeof(localStorage.Upcore_refine_task) == "undefined") { localStorage.Upcore_refine_task=0; }//核心提炼站任务
			if(typeof(localStorage.task_maoqiu) == "undefined") { localStorage.task_maoqiu=0; }//核心提炼站任务

			//彩蛋人物
			if(typeof(localStorage.xiaoxiao) == "undefined") { localStorage.xiaoxiao=0; }	//筱皛

			if(typeof(localStorage.yumao) == "undefined") { localStorage.yumao=0; }//羽毛
			if(typeof(localStorage.changming) == "undefined") { localStorage.changming=0; }//长萌
			if(typeof(localStorage.lingyu) == "undefined") { localStorage.lingyu=0; }//泠鱼
			if(typeof(localStorage.fengshi) == "undefined") { localStorage.fengshi=0; }		//风逝
			if(typeof(localStorage.huoya) == "undefined") { localStorage.huoya=0; }	//霍娅
			if(typeof(localStorage.youzi) == "undefined") { localStorage.youzi=0; }	//柚子
			if(typeof(localStorage.changxi) == "undefined") { localStorage.changxi=0; }	//常曦
			if(typeof(localStorage.hexian) == "undefined") { localStorage.hexian=0; }	//和弦
			if(typeof(localStorage.lvling) == "undefined") { localStorage.lvling=0; }	//律灵
			if(typeof(localStorage.xinghuan) == "undefined") { localStorage.xinghuan=0; }	//星幻

			//战斗员
			if(typeof(localStorage.dis) == "undefined") { localStorage.dis=0; }	//dis
			if(typeof(localStorage.xx_gundams) == "undefined") { localStorage.xx_gundams=0; }//高达
			if(typeof(localStorage.xuemao) == "undefined") { localStorage.xuemao=0; }//雪喵
			if(typeof(localStorage.gugu) == "undefined") { localStorage.gugu=0; }	//咕咕
			if(typeof(localStorage.daoxue) == "undefined") { localStorage.daoxue=0; }		//道雪

			//游戏记录
			if(typeof(localStorage.Defeated) == "undefined") { localStorage.Defeated=0; }//丢人次数
			if(typeof(localStorage.coal_total) == "undefined") { localStorage.coal_total=0; }//总挖岚星晶数量
			if(typeof(localStorage.space_metal_total) == "undefined") { localStorage.space_metal_total=0; }//总星空结晶数量
     		if(typeof(localStorage.booty_coal_total) == "undefined") { localStorage.booty_coal_total=0; }//总战利品岚星晶矿数量
			if(typeof(localStorage.Version_number) == "undefined") { localStorage.Version_number=Version_number;}//版本号
			if(typeof(localStorage.maoqiukill_num) == "undefined") { localStorage.maoqiukill_num=0; }//击败的毛球数量
			if(typeof(localStorage.meiqiukill_num) == "undefined") { localStorage.meiqiukill_num=0; }//击败的煤球数量
			if(typeof(localStorage.dayboss_num) == "undefined") { localStorage.dayboss_num=0; }//击败的每日boss数量
			if(typeof(localStorage.game_round) == "undefined") { localStorage.game_round=0; }//游戏轮次

			game_space_choose=parseFloat(localStorage.game_space_choose);

			Upcore=parseFloat(localStorage.Upcore);
			Lv=parseFloat(localStorage.Lv);
			skillpoint=parseFloat(localStorage.skillpoint);
			skillpoint_total=parseFloat(localStorage.skillpoint_total)

			coal=parseFloat(localStorage.coal);
			space_metal=parseFloat(localStorage.space_metal);
			coal_total=parseFloat(localStorage.coal_total);
			space_metal_total = parseFloat(localStorage.space_metal_total);
			//采集设施
			gain_station=parseFloat(localStorage.gain_station);
			space_gain_station=parseFloat(localStorage.space_gain_station);
			space_refine_station=parseFloat(localStorage.space_refine_station);
			booty_coal_total=parseFloat(localStorage.booty_coal_total);

			damaoxian=parseFloat(localStorage.damaoxian);
			dayboss_victory=parseFloat(localStorage.dayboss_victory);

			//毛球的相关属性
			maoqiu_name=localStorage.maoqiu_name;
			maoqiu_flag=parseFloat(localStorage.maoqiu_flag);
			maoqiu_health=parseFloat(localStorage.maoqiu_health);
			maoqiu_attach=parseFloat(localStorage.maoqiu_attach);
			maoqiu_defend=parseFloat(localStorage.maoqiu_defend);
			maoqiu_speed=parseFloat(localStorage.maoqiu_speed);
			maoqiu_crit = parseFloat(localStorage.maoqiu_crit);

			//煤球的相关属性
			meiqiu_data.meiqiu_name=localStorage.meiqiu_name;
			meiqiu_flag=parseFloat(localStorage.meiqiu_flag);
			meiqiu_data.meiqiu_health=parseFloat(localStorage.meiqiu_health);
			meiqiu_data.meiqiu_attach=parseFloat(localStorage.meiqiu_attach);
			meiqiu_data.meiqiu_defend=parseFloat(localStorage.meiqiu_defend);
			meiqiu_data.meiqiu_speed=parseFloat(localStorage.meiqiu_speed);
			meiqiu_data.meiqiu_crit = parseFloat(localStorage.meiqiu_crit);

			//你的相关属性
			xx_health=parseFloat(localStorage.xx_health);
			xx_health_total=parseFloat((localStorage.xx_health_total))
			xx_attach=parseFloat(localStorage.xx_attach);
			xx_defend=parseFloat(localStorage.xx_defend);
			xx_speed=parseFloat(localStorage.xx_speed);

			gun_name=localStorage.gun_name;
			shield_name=localStorage.shield_name;
			engine_name=localStorage.engine_name;
			xx_guns=parseFloat(localStorage.xx_guns);
			xx_shields=parseFloat(localStorage.xx_shields);
			xx_engines=parseFloat(localStorage.xx_engines);

			//伙伴们
			xx_gundams=parseFloat(localStorage.xx_gundams);
			xuemao=parseFloat(localStorage.xuemao);
			yumao=parseFloat(localStorage.yumao);
			changming=parseFloat(localStorage.changming);
			huoya=parseFloat(localStorage.huoya);
			fengshi=parseFloat(localStorage.fengshi);
			daoxue=parseFloat(localStorage.daoxue);
			xiaoxiao=parseFloat(localStorage.xiaoxiao);
			gugu=parseFloat(localStorage.gugu);
			youzi=parseFloat(localStorage.youzi);
			changxi=parseFloat(localStorage.changxi);
			hexian=parseFloat(localStorage.hexian);
			dis=parseFloat(localStorage.dis);
			lvling=parseFloat(localStorage.lvling);
			xinghuan=parseFloat(localStorage.xinghuan);
			lingyu=parseFloat(localStorage.lingyu);

			//任务系统
			tongxunzhan=parseFloat(localStorage.tongxunzhan);//通讯站
			Upcore_refine_task=parseFloat(localStorage.Upcore_refine_task);//核心提炼站
			task_maoqiu=parseFloat(localStorage.task_maoqiu);//任务用毛球记录

			//游戏记录更新
			Defeated = parseFloat(localStorage.Defeated);
			meiqiukill_num=parseFloat(localStorage.meiqiukill_num);//击败的煤球数量
			maoqiukill_num=parseFloat(localStorage.maoqiukill_num);//击败的毛球数量
			dayboss_num=parseFloat(localStorage.dayboss_num);//击败的dayboss数量
			game_round=parseFloat(localStorage.game_round);//游戏轮次

			if (Version_number!=localStorage.Version_number){//版本检查

				new $Msg({
				title:"游戏更新",
				content: "版本校对完成\n"+update_note
				})
				Clear_();
			}
			document.getElementById("Game_round_txt").innerHTML=game_round;
			fresh_text();// 参数更新
			hide_show();// 界面初始化
			button_check(); //检测按键
			equipment_fresh(); //检测装备显示
			Meiqiudisplay(meiqiu_data.meiqiu_name,meiqiu_data.meiqiu_attach,meiqiu_data.meiqiu_defend,meiqiu_data.meiqiu_speed,meiqiu_data.meiqiu_crit);
			Maoqiudisplay(maoqiu_name,maoqiu_attach,maoqiu_defend,maoqiu_speed,maoqiu_crit);
 		}

		// 更新数值显示
		function fresh_text(){
			localStorage.Lv=Lv;
			friend_att = 1.75*Lv;
			friend_speed = 2*Lv;
			friend_crit = 50;

			localStorage.Upcore=Upcore;
			localStorage.coal=coal.toFixed(0);

			localStorage.gain_station=gain_station;
			localStorage.space_gain_station=space_gain_station;
			localStorage.space_refine_station=space_refine_station;
			localStorage.space_metal=space_metal;
			localStorage.space_metal_total=space_metal_total;
			localStorage.game_space_choose=game_space_choose;

			//maoqiu

			localStorage.dayboss_victory=dayboss_victory;

			localStorage.maoqiu_name=maoqiu_name;
			localStorage.maoqiu_flag=maoqiu_flag;
			localStorage.maoqiu_health=maoqiu_health;//血量
			localStorage.maoqiu_attach=maoqiu_attach;
			localStorage.maoqiu_defend=maoqiu_defend;
			localStorage.maoqiu_speed=maoqiu_speed;

			//小怪
			localStorage.meiqiu_name=meiqiu_data.meiqiu_name;
			localStorage.meiqiu_flag=meiqiu_flag;
			localStorage.meiqiu_health=meiqiu_data.meiqiu_health;//血量
			localStorage.meiqiu_attach=meiqiu_data.meiqiu_attach;
			localStorage.meiqiu_defend=meiqiu_data.meiqiu_defend;
			localStorage.meiqiu_speed=meiqiu_data.meiqiu_speed;
			localStorage.meiqiu_crit=meiqiu_data.meiqiu_crit;

			//你
			yours();
			localStorage.gun_name=gun_name;
			localStorage.shield_name=shield_name;
			localStorage.engine_name=engine_name;

			localStorage.xx_health=xx_health;//血量
			localStorage.xx_guns=xx_guns;
			localStorage.xx_shields=xx_shields;
			localStorage.xx_engines=xx_engines;


			localStorage.xx_attach=xx_attach;
			localStorage.xx_defend=xx_defend;
			localStorage.xx_speed=xx_speed;

			//伙伴
			localStorage.tongxunzhan=tongxunzhan;
			localStorage.changxi=changxi;
			localStorage.youzi=youzi;
			localStorage.hexian=hexian;
			localStorage.dis=dis;

			//记录
			localStorage.Defeated= Defeated;
			localStorage.coal_total=coal_total;
			localStorage.booty_coal_total=booty_coal_total;
			localStorage.maoqiukill_num=maoqiukill_num;
			localStorage.meiqiukill_num=meiqiukill_num;
			localStorage.dayboss_num=dayboss_num;
			localStorage.skillpoint_total=skillpoint_total;


			// document.form1.coal_txt.value = coal;
			// document.form1.power_txt.value = Lv;
			document.getElementById("power_txt").innerHTML = "等级:"+ Lv; 	//更新文本框中的飞船能量显示
			document.getElementById("Upcore_txt").innerHTML = num_change(Upcore)+"/"+(Lv*2); //更新星空结晶数量显示
			document.getElementById("skillpoint").innerHTML= "当前的升级点:"+skillpoint;
			document.getElementById("coal_txt").innerHTML =  num_change(coal.toFixed(0)); 	//更新文本框中的岚星晶矿数量显示
			document.getElementById("Gain_station").innerHTML = "采集站:"+ gain_station; //更新采集站数量显示

			document.getElementById("Spacemetal_txt").innerHTML = num_change(space_metal); //更新星空结晶数量显示
			document.getElementById("Spacegainstation_txt").innerHTML = "星空采集站:"+ space_gain_station; //更新星空采集站数量显示
			document.getElementById("Spacerefinestation_txt").innerHTML = "星空精炼站:"+ space_refine_station; //更新星空经历站数量显示

			maoqiu_health_rato=maoqiu_health/maoqiudata.health_total*100
			if(maoqiu_health_rato>60){
					document.getElementById("Maoqiu_health").style.borderColor="#adeeaf";	//更新血条中的毛球的血量颜色
				}else if(maoqiu_health_rato>20){
					document.getElementById("Maoqiu_health").style.borderColor="#f5cc43";	//更新血条中的毛球的血量颜色
				}else if(20>=maoqiu_health_rato){
					document.getElementById("Maoqiu_health").style.borderColor="#ff7474";	//更新血条中的毛球的血量颜色
				}
			document.getElementById("health_maoqiu").innerHTML =num_change(maoqiu_health.toFixed(0));	//更新文本框中的毛球的血量
			document.getElementById("Maoqiu_health").style.width =maoqiu_health_rato+"%";	//更新血条中的毛球的血量

			meiqiu_health_rato=meiqiu_data.meiqiu_health/meiqiu_data.health_total*100
			if(meiqiu_health_rato>60){
					document.getElementById("Meiqiu_health").style.borderColor="#adeeaf";	//更新血条中的煤球的血量颜色
				}else if(meiqiu_health_rato>20){
					document.getElementById("Meiqiu_health").style.borderColor="#f5cc43";	//更新血条中的煤球的血量颜色
				}else if(20>=meiqiu_health_rato){
					document.getElementById("Meiqiu_health").style.borderColor="#ff7474";	//更新血条中的煤球的血量颜色
				}
			document.getElementById("health_meiqiu_txt").innerHTML =num_change(meiqiu_data.meiqiu_health.toFixed(0));	//更新文本框中敌人血量
			document.getElementById("Meiqiu_health").style.width =meiqiu_health_rato+"%";	//更新血条中的煤球的血量

			document.getElementById("Ship_name").innerHTML = localStorage.ship_name;
			document.getElementById("health_xx").innerHTML = num_change(xx_health.toFixed(0)); 	//更新文本框中的飞船血量
			xx_health_rato=xx_health/xx_health_total*100
			if(xx_health_rato>60){
					document.getElementById("XX_health").style.borderColor="#adeeaf";	//更新血条中的飞船血量颜色
				}else if(xx_health_rato>20){
					document.getElementById("XX_health").style.borderColor="#f5cc43";	//更新血条中的飞船血量颜色
				}else if(20>=xx_health_rato){
					document.getElementById("XX_health").style.borderColor="#ff7474";	//更新血条中的飞船血量颜色
				}
			document.getElementById("XX_health").style.width = xx_health_rato+"%";	//更新血条中的飞船血量
			document.getElementById("Guns_xx").innerHTML = "武器等级:"+ xx_guns;	//更新文本框中的飞船的机关炮数量
			document.getElementById("Shields_xx").innerHTML = "装甲等级:"+ xx_shields;	//更新文本框中的飞船的护盾数量
			document.getElementById("Engine_xx").innerHTML = "引擎等级:"+ xx_engines;	//更新文本框中的飞船的锅炉数量

			document.getElementById("attach_xx").innerHTML = xx_attach; 	//更新文本框中的飞船攻击
			document.getElementById("defend_xx").innerHTML = xx_defend;	//更新文本框中的飞船防御
			document.getElementById("speed_xx").innerHTML =  xx_speed;	//更新文本框中的飞船速度
			document.getElementById("crit_xx").innerHTML = xx_crit; //更新飞船的暴击

			document.getElementById("defeated_record_txt").innerHTML =  Defeated;	//更新被击败次数
			document.getElementById("COALtotal").innerHTML = coal_total;	//更新总挖岚星晶数
			document.getElementById("space_metal_total").innerHTML =  space_metal_total;	//更新星空结晶数
			document.getElementById("bootycoaltotal").innerHTML =  booty_coal_total;	//更新抢夺的岚星晶矿
			document.getElementById("Maoqiutotal").innerHTML =  maoqiukill_num;	//更新战胜的毛球数
			document.getElementById("Meiqiutotal").innerHTML =  meiqiukill_num;	//更新战胜的煤球数
			document.getElementById("skillpointtotal").innerHTML=localStorage.skillpoint_total;
			console.log(localStorage.skillpoint_total);
			document.getElementById("Daybosstotal").innerHTML =  dayboss_num;	//更新战胜的每日boss数

		}
		function Daybossdisplay (dayboss_data) {
			document.getElementById("Dayboss_name").innerHTML=dayboss_data.name+"("+dayboss_data.life_num+"/10)";
			document.getElementById("Dayboss_att").innerHTML=dayboss_data.att;
			document.getElementById("Dayboss_def").innerHTML=dayboss_data.def;
			document.getElementById("Dayboss_speed").innerHTML=dayboss_data.speed;
			document.getElementById("Dayboss_crit").innerHTML=dayboss_data.crit;
		}
		function Maoqiudisplay (maoqiu_name,maoqiu_attach,maoqiu_defend,maoqiu_speed,maoqiu_crit) {
			document.getElementById("maoqiu_name").innerHTML=maoqiu_name;
			document.getElementById("maoqiu_att").innerHTML=maoqiu_attach;
			document.getElementById("maoqiu_def").innerHTML=maoqiu_defend;
			document.getElementById("maoqiu_speed").innerHTML=maoqiu_speed;
			document.getElementById("maoqiu_crit").innerHTML=maoqiu_crit;
		}
		function Meiqiudisplay (meiqiu_name,meiqiu_attach,meiqiu_defend,meiqiu_speed,meiqiu_crit) {
			document.getElementById("meiqiu_name").innerHTML=meiqiu_name;
			document.getElementById("meiqiu_att").innerHTML=meiqiu_attach;
			document.getElementById("meiqiu_def").innerHTML=meiqiu_defend;
			document.getElementById("meiqiu_speed").innerHTML=meiqiu_speed;
			document.getElementById("meiqiu_crit").innerHTML=meiqiu_crit;
		}


		 // 重置存档数据并显示
 		function Clear_(){
 			var game_round=parseFloat(localStorage.game_round);
 			game_round +=Math.floor(Lv/50);

 			if(xx_attach>xx_defend && xx_attach>xx_speed){
 				ship_name="战斗飞船v"+game_round;
			}else if(xx_defend>xx_attach && xx_defend>xx_speed){
 				ship_name="装甲飞船v"+game_round;
			}else if(xx_speed>xx_attach && xx_speed>xx_defend){
 				ship_name="高速飞船v"+game_round;
			}else if(xx_speed==xx_attach){
 				ship_name="高速炮艇v"+game_round;
			}else if(xx_speed==xx_defend){
 				ship_name="装甲快艇v"+game_round;
			}else if(xx_defend==xx_attach){
 				ship_name="装甲炮艇v"+game_round;
			}else if(xx_defend==xx_attach && xx_defend==xx_speed){
 				ship_name="高速战列舰v"+game_round;
			};

			localStorage.clear();
			localStorage.game_round=game_round;
			localStorage.ship_name=ship_name;
			dayboss_victory=0;
			dayboss_flag=0;
			csh_();

			writeLogOl("你获得了"+game_round+"粒超动子");

			gain_station=game_round*5;
 			writeLogOl("你发现了不知道是谁留下的"+gain_station+"座采集站");
			skillpoint=parseFloat(localStorage.skillpoint)+10*game_round;
			skillpoint_total=skillpoint;
 			localStorage.skillpoint = skillpoint;
 			localStorage.skillpoint_total=skillpoint_total;
 			writeLogOl("你通过超动子转换得到了"+localStorage.skillpoint+"点升级点");

 			fresh_text();
			hide_show();
			button_check();

		}



		function Clear_confirm(){    /* 绑定事件 */
 			n=Math.floor(Lv/50);
 			new $Msg({
				title:"重置游戏",
				content:"飞船准备好了随时可以飞向深空，您确定要开始一段新的探索吗吗？将获得超动子 x "+n,
            	confirm:function(){
              		new $Msg({content:"是时候重新出发了，您飞离了岚星向着宇宙深处远去。游戏已重置"});
					Clear_();
            	},
				cancel:function (){
					new $Msg({content:"重置已取消"});
				}
			})

		}

		function tongxunzhan_build(){//通讯站建设
 			if(tongxunzhan==0){
				if (coal>1000&& maoqiukill_num>0 && meiqiukill_num>0){
					new $Msg({title:"通讯站建设",
							content:"你完成了通讯站建设，现在你可以和外界进行联系了"});
					writeLogOl("通讯站建设完毕，开始向宇宙送信！");
					coal-=1000;
					tongxunzhan=1;
					fresh_text();

				}else {
					writeLogOl("材料不足，需要：岚星晶矿1000，并战胜毛球和小怪各1只")
				}
			}else {
 				if(coal>=100){
 					coal-=100;
					writeLogOl("你消耗了100岚星晶矿进行了一次通信");
					i=Math.round(Math.random()*16);
					switch (i) {  //离散值判断
						case 1 :
							writeLogOl("滴滴滴~你和宇宙中的潮澜人进行了一次通信，他们生活在一个全是海洋的星球，你很好奇他们是怎么发展出文明的");
							break;
						case 2 :
							writeLogOl("滴滴滴~你和宇宙中的地球人进行了一次通信，他们自称失去了母星正在流浪，诶我不就是地球人吗？？");
							break;
						case 3 :
							writeLogOl("滴滴滴~你和宇宙中的徙星鸟进行了一次通信，你很好奇对方是怎么独自在宇宙中飞行的，但是对方并不想理你");
							break;
						case 4 :
							writeLogOl("滴滴滴~你和宇宙中的汐海人进行了一次通信，她们是海洋文明，你很好奇她们的飞船是不是个大水缸");
							break;
						case 5 :
							writeLogOl("滴滴滴~你和宇宙中的祈月人进行了一次通信，对方试图说服你信仰某个宗教，但是你没听明白是什么");
							break;
						case 6 :
							writeLogOl("滴滴滴~你和宇宙中的昕羽进行了一次通信，昕羽的科学家告诉你如何利用电磁波寻找岚星晶矿，你试了下还真行！！岚星晶矿+1");
							coal=coal+1;
							coal_total=coal_total+1;
							fresh_text();
							break;
						case 7 :
							writeLogOl("滴滴滴~你和宇宙中的恒洸进行了一次通信，对方自称有2600多岁了，你很羡慕并且试图说服自己他们只是的公转周期更快");
							break;
						case 8 :
							writeLogOl("滴滴滴~你和宇宙中的妖族进行了一次通信，你很震惊小时候故事里的种族真的存在，你满脑子想着兽耳娘形象，没注意对方接下来说了什么");
							break;
						case 9 :
							writeLogOl("滴滴滴~你和宇宙中的织梦者进行了一次通信，对方只是好奇的瞥了一下，你无法理解对方的存在，但是你好像抓住了什么灵感");
							break;
						case 10 :
							writeLogOl("滴滴滴~你和宇宙中的灵魂调制者进行了一次通信，对方好像很有兴趣的发送了很多信息，但是只看见通信灯闪烁却完全没接受到");
							break;
						case 11 :
							writeLogOl("滴滴滴~你和宇宙中的毛玉进行了一次通信，对方没说几句话就被一个叫理香子的抓走了");
							break;
						case 12 :
							writeLogOl("滴滴滴~你和宇宙中的樱陌进行了一次通信，对方告诉你高数很重要，要好好学");
							break;
						case 13 :
							if (xinghuan!=1){
								xinghuan=1;
								writeLogOl("滴滴滴~你与星幻建立了联系，他指导你进行了一次土法升级核心提炼，你获得了升级核心+10");
								Upcore+10;
								localStorage.xinghuan=xinghuan;
								fresh_text();
								hide_show()
							}else {
								writeLogOl("滴滴滴~你和宇宙中的不知名种族进行了一次通信，不过你完全没看懂他们的信号");
							}
							break;
						case 14 :
							writeLogOl("滴滴滴~你接到了一个神秘组织的赏金任务！");
							Get_dayboss();
							break;
						default :
							if (dis!=1){
								dis=1;
								writeLogOl("滴滴滴~你与dis完成了一次交易，他前来帮助你战斗了");
								hide_show()
							}else {
								writeLogOl("滴滴滴~你和宇宙中的不知名种族进行了一次通信，不过你完全没看懂他们的信号");
							}

							break;
					}

				}else {
 					writeLogOl("晶矿不足，需要：岚星晶矿100")
				}

			}
		}

		// 界面的显示与隐藏
		function hide_show(){
 			if (game_round>0){
 				document.getElementById("round").style.display="inline-block"
			}else {
 				document.getElementById("round").style.display="none"
			}
 			if (Lv>50){
 				document.getElementById('Save').innerHTML = "探索深空";
			}
			if	(Defeated>0){//记录
				document.getElementById("record").style.display="inline-block";
			}else {
				document.getElementById("record").style.display="none";
			}
			if (dayboss_num!=0){
				document.getElementById("Daybosskillnum").style.display="inline-block";
			}
			//星空采集系统
			if (game_space_choose!=0){
				document.getElementById("space_gain_station_button").style.display="inline-block";
				document.getElementById("space_refine_station_button").style.display="inline-block";
				document.getElementById("Spacemetal").style.display="inline-block";
				document.getElementById("Spacegainstation").style.display="inline-block";
				document.getElementById("Spacerefinestation").style.display="inline-block"
				document.getElementById("equipment_button").style.display="inline-block";
				document.getElementById("equipment_up_button").style.display="inline-block";

			}else {
				document.getElementById("space_gain_station_button").style.display="none";
				document.getElementById("space_refine_station_button").style.display="none";
				document.getElementById("Spacemetal").style.display="none";
				document.getElementById("Spacegainstation").style.display="none";
				document.getElementById("Spacerefinestation").style.display="none"
				document.getElementById("equipment_button").style.display="none";
				document.getElementById("equipment_up_button").style.display="none";

			}
			//大冒险功能键
			// if(damaoxian==1){
			// 	document.getElementById("Damaoxian_button").style.display="";
			// }else {
			// 	document.getElementById("Damaoxian_button").style.display="none";
			// }

			//战斗3按键
			if(meiqiu_flag==1 || maoqiu_flag==1 || dayboss_flag==1){
				document.getElementById("repair_button").style.display="";

				document.getElementById("escape_button").style.display="";

				if(daoxue==1){
					document.getElementById("daoxue_fight_button").style.display="";
				}else {
					document.getElementById("daoxue_fight_button").style.display="none";
				}

			}else {
				document.getElementById("repair_button").style.display="none";
				document.getElementById("daoxue_fight_button").style.display="none";
				document.getElementById("escape_button").style.display="none";
			}

			if(xx_health<(xx_health_total/2)){
				document.getElementById("repair_button").style.display="";
			}


			//雪喵
			if (xuemao!=0){
				document.getElementById("Xuemao").style.visibility="visible";
			}else {
				document.getElementById("Xuemao").style.visibility="hidden";
			}
			//羽毛
			if (yumao!=0){
				document.getElementById("Yumao").style.visibility="visible";
			}else {
				document.getElementById("Yumao").style.visibility="hidden";
			}
			//长明
			if (changming!=0){
				document.getElementById("Changming").style.visibility="visible";
			}else {
				document.getElementById("Changming").style.visibility="hidden";
			}
			//霍娅
			if (huoya!=0){
				document.getElementById("Huoya").style.visibility="visible";
			}else {
				document.getElementById("Huoya").style.visibility="hidden";
			}
			//风逝
			if (fengshi!=0){
				document.getElementById("Fengshi").style.visibility="visible";
			}else {
				document.getElementById("Fengshi").style.visibility="hidden";
			}
			//筱皛
			if (xiaoxiao!=0){
				document.getElementById("Xiaoxiao").style.visibility="visible";
				document.getElementById("tongxunzhan_task").style.display="";
			}else {
				document.getElementById("Xiaoxiao").style.visibility="hidden";
				document.getElementById("tongxunzhan_task").style.display="none";
			}
			//律灵
			if (lvling!=0){
				document.getElementById("Lvling").style.visibility="visible";
				document.getElementById("Upcore_refine_task").style.display="";
			}else {
				document.getElementById("Lvling").style.visibility="hidden";
				document.getElementById("Upcore_refine_task").style.display="none";
			}
			//dis
			if (dis!=0){
				document.getElementById("Dis").style.visibility="visible";
			}else {
				document.getElementById("Dis").style.visibility="hidden";
			}
			//星幻
			if (xinghuan!=0){
				document.getElementById("Xinghuan").style.visibility="visible";
			}else {
				document.getElementById("Xinghuan").style.visibility="hidden";
			}

			//咕咕
			if (gugu!=0){
				document.getElementById("Gugu").style.visibility="visible";
			}else {
				document.getElementById("Gugu").style.visibility="hidden";
			}
			//柚子
			if (youzi!=0){
				document.getElementById("Youzi").style.visibility="visible";
			}else {
				document.getElementById("Youzi").style.visibility="hidden";
			}
			//和弦
			if (hexian!=0){
				document.getElementById("Hexian").style.visibility="visible";
			}else {
				document.getElementById("Hexian").style.visibility="hidden";
			}
			//常曦
			if (changxi!=0){
				document.getElementById("Changxi").style.visibility="visible";
			}else {
				document.getElementById("Changxi").style.visibility="hidden";
			}
			//泠鱼
			if (lingyu!=0){
				document.getElementById("Lingyu").style.visibility="visible";
				document.getElementById("Equipbox").style.display="";
			}else {
				document.getElementById("Lingyu").style.visibility="hidden";
				document.getElementById("Equipbox").style.display="none";
			}

			//道雪
			if (daoxue==1){
				document.getElementById("Daoxue").style.visibility="visible";

			}else {
				document.getElementById("Daoxue").style.visibility="hidden";
			}

			//高达
			if (xx_gundams==1){
				document.getElementById("Gundam").style.visibility="visible";
			}else {
				document.getElementById("Gundam").style.visibility="hidden";
			}
			//毛球战胜数量
			if (maoqiukill_num!=0){
				showLayer("Maoqiukillnum");
			}

			//煤球战胜的数量
			if (meiqiukill_num!=0){
				showLayer("Meiqiukillnum");
			}

			if (maoqiu_flag==1){//毛球战界面
				document.getElementById("F6_maoqiu").style.display="inline-table";
			}else{
				document.getElementById("F6_maoqiu").style.display="none";
			}

			if(meiqiu_flag==1){//小怪战界面
				document.getElementById("F7_meiqiu").style.display="inline-table";
			}else{
				document.getElementById("F7_meiqiu").style.display="none";
			}

			if (dayboss_flag==1){//每日boss战界面
				document.getElementById("F8_Dayboss").style.display="inline-table";
			}else {
				document.getElementById("F8_Dayboss").style.display="none";
			}



		}

		//放置逻辑
        //计时函数
		var second=0;
        function timer(){
            second++;
            document.getElementById('timeValue').value=second+'秒';
        }
		var clock;//计时器
        function resetTimer()//重置
        {
            clearInterval(clock);
            second=0;
            document.getElementById('timeValue').value=second+'秒';
        }
        function startTimer()//开始
        {
            clock=setInterval(timer,1000);
        }
        function stopTimer() {
            //停止计时
            clearInterval(clock);
            document.getElementById('timeValue').value=second+'秒';
        }

        //自动回复功能
		var heal_flag=0;
		function startheal()//开始自动回血
        {
        	if (heal_flag==0){
				heal=setInterval(
        		function (){
        			if(xx_health<xx_health_total){
        				if (coal>0){
        					if (coal>(Math.ceil(xx_health_total/200)+20)){
        						xx_health+=Math.ceil(xx_health_total/200);
								coal-=Math.ceil(xx_health_total/200);
							}else{
        						xx_health++;
        						coal--;
							}

						}else {
        					writeLogOl("晶矿不足");
						}
        				if(xx_health<(xx_health_total/3)){
        					if(Math.random()>0.99){
        						writeLogOl("路过的符华仙人撒下了一片纳米修复机器人，飞船血量大回升");
								xx_health+=Math.round(xx_health_total/3);
							}
						}

					}
				},1000 //每秒回血1点
				);
				document.getElementById('heal_button_id').value = "自动修复中";
				document.getElementById('heal_button_id').className = "button1";
				heal_flag=1;
			}else {
        		stopheal();
        		heal_flag=0;
			}
        }

		//关闭自动回血
        function stopheal()
		{
            clearInterval(heal);
            document.getElementById('heal_button_id').value = "停止修复";
            document.getElementById('heal_button_id').className = "button_fail";
        }

		 //初始一般概率自动挖掘
		setInterval(
		function(){

			gain_(5);
			if (changming==1){
				gain_(10);
				gain_(10);
			}
			if (yumao==1){
				gain_(10);
				if(Math.random()>0.995){
					writeLogOl("羽羽用探测器发现了大矿藏，收获岚星晶矿"+(Lv*Lv+10));
					coal=coal+(Lv*Lv+10);
					coal_total=coal_total+(Lv*Lv+10);
					fresh_text();
				}
			}
			if (huoya==1){
				coal+=3;	//岚星晶矿+3
				coal_total+=3; //总数+3
				fresh_text();
			}

		},1000);	//每1秒执行一次 gain_函数,较高几率参数

		//采集站自动采集
		var coal_gain_station=0;
		setInterval(
			function () {
				if (huoya==0){
					coal+=gain_station*(1+game_round);	//岚星晶矿+0.5
					coal_total+=gain_station*(1+game_round); //总数+0.5
					coal_gain_station+=(1+game_round); //采集站采集总数加1/3s
				}else {
					coal+=gain_station*(1.5+game_round);	//岚星晶矿+0.75
					coal_total+=gain_station*(1.5+game_round); //总数+0.75
					coal_gain_station+=(1.5+game_round); //采集站采集总数加1.5/3s
				}
				if(gain_station>50){//采集站组网
					coal+=Math.floor(gain_station/50)*Math.floor(gain_station/50)*5;
					coal_total+=Math.floor(gain_station/50)*Math.floor(gain_station/50)*5;
					coal_gain_station=Math.floor(gain_station/50)*Math.floor(gain_station/50)*5;
				}

				// if(coal_gain_station>=300){ //每座采集站能采集300矿
				// 	gain_station-=1; //采集站关闭
				// 	writeLogOl("有一座采集站资源枯竭了，采集站-1")
				// }

				fresh_text();
				button_check();

			}, 2000);
		//星空采集站自动采集
		setInterval(
			function () {
				if (huoya==0){
					space_metal+=space_gain_station*(1+game_round);	//岚星晶矿+0.1
					space_metal_total+=space_gain_station*(1+game_round); //总数+0.1
				}else {
					space_metal+=space_gain_station*(1.5+game_round);	//岚星晶矿+0.15
					space_metal_total+=space_gain_station*(1.5+game_round); //总数+0.15
				}

				fresh_text();
				button_check();
			}, 10000);
		// 星空提炼站自动提炼
		setInterval(
			function () {
				if(coal>5*space_refine_station*(1+game_round)){
					space_metal+=space_refine_station*(1+game_round);	//岚星晶矿+0.1
					space_metal_total+=space_refine_station*(1+game_round); //总数+0.1
					coal-=5*(space_refine_station*(1+game_round));
				}
				fresh_text();
				button_check();
			}, 5000);


		// 你的自动战斗逻辑
		var qishe=0;
		setInterval(
			function Youfight(){
				if(maoqiu_flag==1){
					health_loss=your_fight().health_loss_maoqiu;
					health_loss.health_loss=Math.ceil(health_loss.health_loss)
					maoqiu_health-= health_loss.health_loss;
					writeyourfightlog("你","maoqiu",health_loss);

					if (xx_gundams>0){
						health_loss=fight_(xx_health,maoqiu_health, friend_att, maoqiu_defend,
								friend_speed,maoqiu_speed,friend_crit);

						health_loss.health_loss=Math.ceil(health_loss.health_loss)
						maoqiu_health-= health_loss.health_loss;
						writeyourfightlog("高达","maoqiu",health_loss);
					}
					if (xuemao>0){
						health_loss=fight_(xx_health,maoqiu_health, friend_att, maoqiu_defend,
								friend_speed,maoqiu_speed,friend_crit);
						health_loss.health_loss=Math.ceil(health_loss.health_loss)
						maoqiu_health-= health_loss.health_loss;
						writeyourfightlog("雪喵","maoqiu",health_loss);
					}
					if (xiaoxiao>0){
						health_loss=fight_(xx_health,maoqiu_health, friend_att, maoqiu_defend,
								friend_speed,maoqiu_speed,friend_crit);
						health_loss.health_loss=Math.ceil(health_loss.health_loss)
						maoqiu_health-= health_loss.health_loss;
						writeyourfightlog("筱皛","maoqiu",health_loss);

					}
					if (dis>0){
						health_loss=fight_(xx_health,maoqiu_health, friend_att, maoqiu_defend,
								friend_speed,maoqiu_speed,friend_crit);
						health_loss.health_loss=Math.ceil(health_loss.health_loss)
						maoqiu_health-= health_loss.health_loss;
						writeyourfightlog("dis","maoqiu",health_loss);

					}

					if (xiaoxiao==1){
						if (Math.random()>0.9){
						qishe=Math.floor(1.5*xx_guns+(Math.random()*xx_guns));
						maoqiu_health-= qishe;
						writeLogOl02("筱皛发动了一次齐射！对毛球造成了"+qishe+"伤害","orange");
						}
					}

					if (maoqiu_health<0){
						maoqiu_health=-1;
						fresh_text();
					}
					//战胜结算
					fight_end();
				}

				if(meiqiu_flag==1){
					health_loss=your_fight().health_loss_meiqiu;
					health_loss.health_loss=Math.ceil(health_loss.health_loss)
					meiqiu_data.meiqiu_health-= health_loss.health_loss;
					writeyourfightlog("你","meiqiu",health_loss);

					if (xx_gundams>0){
						health_loss=fight_(xx_health,meiqiu_data.meiqiu_health, friend_att, meiqiu_data.meiqiu_defend,
								friend_speed,meiqiu_data.meiqiu_speed,friend_crit);;
						health_loss.health_loss=Math.ceil(health_loss.health_loss)
						meiqiu_data.meiqiu_health-= health_loss.health_loss;
						writeyourfightlog("高达","meiqiu",health_loss);

					}

					if (xuemao>0){
						health_loss=fight_(xx_health,meiqiu_data.meiqiu_health, friend_att, meiqiu_data.meiqiu_defend,
								friend_speed,meiqiu_data.meiqiu_speed,friend_crit);;
						health_loss.health_loss=Math.ceil(health_loss.health_loss)
						meiqiu_data.meiqiu_health-= health_loss.health_loss;
						writeyourfightlog("雪喵","meiqiu",health_loss);
					}
					if (xiaoxiao>0){
						health_loss=fight_(xx_health,meiqiu_data.meiqiu_health, friend_att, meiqiu_data.meiqiu_defend,
								friend_speed,meiqiu_data.meiqiu_speed,friend_crit);;
						health_loss.health_loss=Math.ceil(health_loss.health_loss)
						meiqiu_data.meiqiu_health-= health_loss.health_loss;
						writeyourfightlog("筱皛","meiqiu",health_loss);
					}
					if (dis>0){
						health_loss=fight_(xx_health,meiqiu_data.meiqiu_health, friend_att, meiqiu_data.meiqiu_defend,
								friend_speed,meiqiu_data.meiqiu_speed,friend_crit);;
						health_loss.health_loss=Math.ceil(health_loss.health_loss)
						meiqiu_data.meiqiu_health-= health_loss.health_loss;
						writeyourfightlog("dis","meiqiu",health_loss);
					}

					if (xiaoxiao==1){
						if (Math.random()>0.9){
						qishe=Math.floor(1.5*xx_guns+(Math.random()*xx_guns));
						meiqiu_data.meiqiu_health-= qishe;
						writeLogOl02("筱皛发动了一轮齐射，对"+meiqiu_data.meiqiu_name+"造成"+qishe+"伤害","orange");
						}
					}

					if (meiqiu_data.meiqiu_health<0){
						meiqiu_data.meiqiu_health=-1;
						fresh_text();
					}

					fight_end();

				}

				if (dayboss_flag==1){
					health_loss=fight_(xx_health,xx_health, xx_attach, dayboss_data.def, xx_speed,dayboss_data.speed,xx_crit);
					health_loss.health_loss=Math.ceil(health_loss.health_loss);
					dayboss_data.health-= health_loss.health_loss;
					writeyourfightlog("你","dayboss",health_loss);

					if (xx_gundams>0){
						health_loss=fight_(xx_health,xx_health, friend_att, dayboss_data.def, friend_speed,dayboss_data.speed,friend_crit);
						health_loss.health_loss=Math.ceil(health_loss.health_loss);
						dayboss_data.health-= health_loss.health_loss;
						writeyourfightlog("高达","dayboss",health_loss);
					}

					if (xuemao>0){
						health_loss=fight_(xx_health,xx_health, friend_att, dayboss_data.def, friend_speed,dayboss_data.speed,friend_crit);
						health_loss.health_loss=Math.ceil(health_loss.health_loss);
						dayboss_data.health-= health_loss.health_loss;
						writeyourfightlog("雪喵","dayboss",health_loss);
					}
					if (xiaoxiao>0){
						health_loss=fight_(xx_health,xx_health, friend_att, dayboss_data.def, friend_speed,dayboss_data.speed,friend_crit);
						health_loss.health_loss=Math.ceil(health_loss.health_loss);
						dayboss_data.health-= health_loss.health_loss;
						writeyourfightlog("筱皛","dayboss",health_loss);
					}
					if (dis>0){
						health_loss=fight_(xx_health,xx_health, friend_att, dayboss_data.def, friend_speed,dayboss_data.speed,friend_crit);
						health_loss.health_loss=Math.ceil(health_loss.health_loss);
						dayboss_data.health-= health_loss.health_loss;
						writeyourfightlog("dis","dayboss",health_loss);
					}
					if (gugu>0){
						health_loss=fight_(xx_health,xx_health, friend_att, dayboss_data.def, friend_speed,dayboss_data.speed,friend_crit);
						health_loss.health_loss=Math.ceil(health_loss.health_loss);
						dayboss_data.health-= health_loss.health_loss;
						writeyourfightlog("咕咕","dayboss",health_loss);
					}
					if (xiaoxiao==1){
						if (Math.random()>0.9){
						qishe=Math.floor(1.5*xx_guns+(Math.random()*xx_guns));
						dayboss_data.health-= qishe;
						writeLogOl02("筱皛发动了一轮齐射，对"+dayboss_data.name+"造成"+qishe+"伤害","orange");
						}
					}

				}
				//结束判断
				fight_end();

				fresh_text();

		}
		,2000);

		function fight_end(){
			Upcore_I=Math.floor(Lv/10);
			//煤球战胜结算
			if(meiqiu_flag==1){//战胜结算

				if (meiqiu_data.meiqiu_health<=0 && xx_health>0){
					writeLogOl02("经过了一番苦斗，你战胜了"+meiqiu_data.meiqiu_name)
					writeLogOl("经过了一番苦斗，你战胜了"+meiqiu_data.meiqiu_name+"！并且夺取了岚星晶矿+"+(5*Lv)+" 升级核心+"+(1+Upcore_I))
					Upcore=Upcore+1+Upcore_I;
					coal=coal+(5*Lv);	//岚星晶矿战利品
					booty_coal_total+=(5*Lv);	//统计战利品数量
					meiqiukill_num++;
					//咕咕拯救
					if(meiqiukill_num > 100 && gugu==0){
						save_gugu();
					}
					meiqiu_flag=0;
					fresh_text();	//更新文本框中的岚星晶矿数量
					hide_show();	//结束战斗恢复显示界面
				}
			}

			//毛球战胜结算
			if(maoqiu_flag==1){
				if (maoqiu_health<=0){
					writeLogOl02("经过艰苦的战斗，你打败了霸主毛球")
					writeLogOl("经过艰苦的战斗，你打败了霸主毛球，薅到了岚星晶矿+"+(35+Lv*5)+" 升级核心+"+(10+Upcore_I))
					Upcore=Upcore+10+Upcore_I;
					coal+=35+Lv*5;
					coal_total++;
					booty_coal_total+=35+Lv*5;
					maoqiukill_num++;
					maoqiu_flag=0;
					mao_t=0;

					fresh_text();	//更新文本框中的岚星晶矿数量
					hide_show();	//结束战斗恢复显示界面
					maoqiu_health=parseFloat(localStorage.maoqiu_health);//退循环
				}
			}

			//每日boss结束判断
			if(dayboss_flag==1){
				if(dayboss_data.health<0){
					localStorage.dayboss_data_lifenum-=1;
					if(localStorage.dayboss_data_lifenum>=0){
						dayboss_data.health=Math.round(Math.pow(Lv,1.8)*2+10*Lv)*(Math.random()+1)*5;
						dayboss_data.health_total=dayboss_data.health;
						coal+=10*Lv*Lv;
						booty_coal_total+=10*Lv*Lv;	//统计战利品数量
						Upcore=Upcore+20+Upcore_I;
						writeLogOl("你捡到了"+dayboss_data.name+"掉落的"+(10*Lv*Lv)+"岚星晶矿、"+
						(20+Upcore_I)+"单位升级核心");

					}else{
						dayboss_victory=1;
						dayboss_num++; //统计每日boss战胜数量
						dayboss_flag=0;
						coal+=10*Lv*Lv;
						booty_coal_total+=10*Lv*Lv;	//统计战利品数量
						space_metal+=10*Lv*Lv;
						space_metal_total+=10*Lv*Lv;
						Upcore+=10*Lv
						writeLogOl("你打败了"+dayboss_data.name+"，收获了岚星晶矿+"+(10*Lv*Lv)
						+"，收获了星空结晶+"+(10*Lv*Lv)+"，收获了升级核心+"+(Lv*10));
					}

				}

				fresh_text();//更新文本框中的岚星晶矿数量
				hide_show();//结束战斗恢复显示界面
				document.getElementById("Dayboss_health").innerHTML=num_change(dayboss_data.health.toFixed(0)); //更新boss的血量
				dayboss_health_rato=dayboss_data.health/dayboss_data.health_total*100
				if(dayboss_health_rato>60){
					document.getElementById("Dboss_health").style.borderColor="#adeeaf";	//更新血条中的boss的血量颜色
				}else if(dayboss_health_rato>20){
					document.getElementById("Dboss_health").style.borderColor="#f5cc43";	//更新血条中的boss的血量颜色
				}else if(20>=dayboss_health_rato){
					document.getElementById("Dboss_health").style.borderColor="#ff7474";	//更新血条中的boss的血量颜色
				}
				document.getElementById("Dboss_health").style.width =dayboss_health_rato+"%";	//更新血条中的boss的血量
				document.getElementById("Dayboss_name").innerHTML=dayboss_data.name + "("+localStorage.dayboss_data_lifenum+"/10)"; //更新boss的血量
			}
			Up_power();
		}

		function writeyourfightlog(your,name,fight_data){

			var attacher_name=your;
			if (name=="meiqiu"){
				var enmey_name = meiqiu_data.meiqiu_name;

			}else if(name=="maoqiu"){

				var enmey_name = maoqiu_name;

			}else if(name=="dayboss"){
				var enmey_name = dayboss_data.name
			}else if(name == "你"){
				var enmey_name = "你"
			}
			health_loss=fight_data.health_loss;

			if(dayboss_flag==1 && attacher_name==dayboss_data.name){
				if (fight_data.attached==0){
				writeLogOl02(attacher_name+"攻击了"+enmey_name +"，但是未命中","#ff8984");
				}else {
					if(fight_data.crited==1){
						if(fight_data.defended==0){
							writeLogOl02(attacher_name+"打出了暴击！对"+enmey_name+"造成了" +health_loss+"伤害","#ff423c");
						}else {
							writeLogOl02(attacher_name+"打出了暴击！但是被挡住了，只对"+enmey_name+"造成了"  +health_loss+"伤害","#c64946");
						}
					}else {
						if(fight_data.defended==0){
							writeLogOl02(attacher_name+"攻击了"+enmey_name +"，造成了"+health_loss+"伤害","#ba4a45");
						}else {
							writeLogOl02(attacher_name+"攻击了"+enmey_name +"但是被挡住了，造成了"+health_loss+"伤害","#ba4a45");
						}
					}
				}
			}else {
				if (fight_data.attached==0){
				writeLogOl02(attacher_name+"攻击了"+enmey_name +"，但是未命中");
			}else {
				if(fight_data.crited==1){
					if(fight_data.defended==0){
						writeLogOl02(attacher_name+"打出了暴击！对"+enmey_name+"造成了" +health_loss+"伤害","#ff6347");
					}else {
						writeLogOl02(attacher_name+"打出了暴击！但是被挡住了，只对"+enmey_name+"造成了"  +health_loss+"伤害","#ff837c");
					}
				}else {
					if(fight_data.defended==0){
						writeLogOl02(attacher_name+"攻击了"+enmey_name +"，造成了"+health_loss+"伤害");
					}else {
						writeLogOl02(attacher_name+"攻击了"+enmey_name +"但是被挡住了，造成了"+health_loss+"伤害");
					}
				}
			}
			}



		}
		//每日boss战逻辑
		setInterval(
		function (){
			if(dayboss_flag==1){				//攻击者血,  防御者血,攻击者攻击值，防御者防御值，攻击者速度，防御者速度
				var fight_data_dayboss=fight_(xx_health,xx_health, dayboss_data.att, xx_defend, dayboss_data.speed, xx_speed,dayboss_data.crit);
				fight_data_dayboss.health_loss=Math.ceil(fight_data_dayboss.health_loss);
				health_loss=fight_data_dayboss.health_loss;
				xx_health-=health_loss;

				writeyourfightlog(dayboss_data.name,"你",fight_data_dayboss);

				if (xx_health<0){
					xx_health=-1;
				}

				//检测是否结束游戏
				if (xx_health<0){
					writeLogOl("你遭遇了"+dayboss_data.name+"，可惜实力差距太大，完全被敌人玩弄于鼓掌之中！！！")
					writeLogOl("不过你醒悟得早，及时跑路了。。")
					writeLogOl02("被"+dayboss_data.name+"打败了")

					dayboss_flag=0;
					hide_show();
					xx_health=1;

				}
				fresh_text();//战败结束boss战斗更新文本框中的岚星晶矿数量
			}
		},5000)

		// 毛球战逻辑
		setInterval(
		function(){

			if(maoqiu_flag==1){

				maoqiu_fight();

				//检测是否结束游戏
				if (xx_health<0){
					writeLogOl("你向霸主毛球英勇的发动了攻击，可惜实力差距太大，你被霸主毛球一个扑倒就控制了！！！")
					writeLogOl("霸主毛球玩弄了你一下午，丢下了一块岚星晶矿就走了。。")
					writeLogOl02("被霸主毛球打败了")
					Defeated++;
					coal++;
					booty_coal_total++;
					maoqiu_flag=0;
					mao_t=0;
					hide_show();
					xx_health=1;

				}

				if (maoqiu_health<=0){

					writeLogOl02("经过艰苦的战斗，你打败了霸主毛球")
					writeLogOl("经过艰苦的战斗，你打败了霸主毛球，薅到了岚星晶炭"+(35+Lv*5))
					coal+=35+Lv*5;
					coal_total++;
					booty_coal_total+=35+Lv*5;
					maoqiukill_num++;
					maoqiu_flag=0;
					mao_t=0;

					hide_show();
					maoqiu_health=parseFloat(localStorage.maoqiu_health);//退循环

				}
			}

			fresh_text();//毛球战逻辑

		},2000);


		// 小怪战逻辑
		setInterval(
		function(){
			//检测小怪战
			if(meiqiu_flag==1){

				meiqiu_fight();

				//检测是否结束战斗

			if (meiqiu_data.meiqiu_health>0 && xx_health<0){

				//战斗结算
				writeLogOl02("被"+meiqiu_data.meiqiu_name+"打败了")
				writeLogOl("好可怕! 你被打败了，逃走的时候遗失了岚星晶矿 "+(Math.floor(0.5*gain_station)))
				coal=coal-Math.floor(0.5*gain_station);	//岚星晶矿丢失

				if (coal<0){//避免负数
					coal=0;
				}

				meiqiu_flag=0;

				//从存档中取回血量
				xx_health=1;

				fresh_text();	//// 小怪战逻辑
				hide_show();	//恢复显示界面

			}
			}

		},2000);


		//根据传递的岚星晶矿几率参数决定收益并显示
		function gain_(num){

			if (Math.floor(Math.random()*10+1)<num){	//根据参数决定获取几率

				coal++;	//岚星晶矿+1
				coal_total++; //总数+1
				if(xiaoxiao==0 && coal_total>=100){
					xiaoxiao=1;
					writeLogOl("筱皛看见了你挖矿，再听你叙述完你的情况后，筱皛决定来帮助你！");
					writeLogOl("获得自动技能【火炮齐射】");
					localStorage.xiaoxiao=xiaoxiao;

					new $Msg({
						content: "筱皛给你提供了对外联系的方法",
						title:"任务要求",
						confirm:function (){
							new $Msg({content: "建设通讯站需要：岚星晶矿1000，战胜1只毛球，战胜1只煤球等小怪",
								title:"任务要求"})
						}
					})
					hide_show();
				}

				if(coal_total>=meiqiu_time && meiqiu_flag!=1 && Math.random()>PR_meiqiu){//挂机时自动遇见煤球,已经有煤球就不再自动触发
					writeLogOl("总有人不想让你安心挖矿~")
					meiqiu();
					hide_show();
				}

				fresh_text();

			}

		}

		function button_check(){

			if(gain_station<Lv+50 && coal>=gain_station*10+20) {
				document.getElementById("gain_station_button").className="button1";
			}else {
				document.getElementById("gain_station_button").className="button_fail";
			}

			if(space_metal>=Lv*10){
				document.getElementById("equipment_button").className="button1";
			}else {
				document.getElementById("equipment_button").className="button_fail";
			}
			if(coal>=Lv*10){
				document.getElementById("equipment_up_button").className="button1";
			}else {
				document.getElementById("equipment_up_button").className="button_fail";
			}
			//星空站
			if(space_gain_station<Lv+10 && coal>=gain_station*5+space_gain_station*10) {
				document.getElementById("space_gain_station_button_txt").className="button1";
			}else {
				document.getElementById("space_gain_station_button_txt").className="button_fail";
			}
			if(space_refine_station<Math.ceil(gain_station/2) &&coal>=gain_station*5+space_refine_station*10 ) {
				document.getElementById("space_refine_station_button_txt").className="button1";
			}else {
				document.getElementById("space_refine_station_button_txt").className="button_fail";
			}
			// 升级武器
			if(skillpoint>0){
				document.getElementById("gun_button").className="button1";
			}else {
				document.getElementById("gun_button").className="button_fail";
			}
			//升级防御
			if(skillpoint>0){
				document.getElementById("shield_button").className="button1";
			}else {
				document.getElementById("shield_button").className="button_fail";
			}
			//升级引擎
			if(skillpoint>0){
				document.getElementById("engine_button").className="button1";
			}else {
				document.getElementById("engine_button").className="button_fail";
			}


			if(tongxunzhan==1){
				document.getElementById("tongxunzhan_button").value="进行通讯";
				document.getElementById("tongxunzhan_button").className="button1";
			}else {
				document.getElementById("tongxunzhan_button").value="建设通讯站";
				if (coal>1000&& maoqiukill_num>0 && meiqiukill_num>0){
					document.getElementById("tongxunzhan_button").className="button1";
				}else {
					document.getElementById("tongxunzhan_button").className="button_fail";
				}
			}
			if(Upcore_refine_task==1){
				document.getElementById("Upcore_refine_button").className="button1";
			}else {
				// document.getElementById("Upcore_refine_button").value="建设通讯站";
				if(maoqiukill_num>=(task_maoqiu+10) && xinghuan==1 && coal>=5000 && space_metal>=1000){
					document.getElementById("Upcore_refine_button").className="button1";
				}else {
					document.getElementById("Upcore_refine_button").className="button_fail";
				}
			}

		}

		function Choose_equipment1_button(){
			if (equip1==0){
				equip1=1;
				equip2=0;
			}else {
				writeLogOl("当前已经装备护卫1")
			}
			equipment_fresh();

		}
		function Choose_equipment2_button(){
			if (equip2==0){
				equip2=1;
				equip1=0;
			}else {
				writeLogOl("当前已经装备护卫2")
			}
			equipment_fresh();

		}

		//点挖挖岚星晶矿的按钮逻辑
		function Wa_coal(){

			if (maoqiu_flag==0){ //毛球战进行时无法挖矿/刷新毛球
				gain_(8);	//较高概率
			}

			if (huoya==0 && changming==1 && Math.random()>0.98){
				if (Math.random()>0.2){
					writeLogOl("你在野外碰见了找长萌的霍娅！经过长萌的劝说，霍娅决定留下来帮助你！")
					writeLogOl("挖矿效率极大提升了！")
					huoya=1;

					if (huoya==1){
						timer=setTimeout(
							function(){
								writeLogOl("霍娅忙活了一阵，玩累了就回去了");
								huoya=0;
								localStorage.huoya=huoya;
								fresh_text();
								hide_show();
							},30000
						)
					}

					localStorage.huoya=huoya;
					hide_show();
				}else {
					writeLogOl("你在野外碰见了找长萌的霍娅！")
					writeLogOl("霍娅带走了长萌！挖矿效率下降了！")
					changming=0;
					localStorage.changming=changming;
					hide_show();
				}
			}

			if (changming==0 && Math.random()>0.98){
				writeLogOl("你在野外遇见了长萌！长萌很好的治愈了你，挖矿效率提升了！")
				changming=1;
				localStorage.changming=changming;
				hide_show();
			}


			if(yumao==0 && Math.random()>0.999){
				writeLogOl("好幸运，你在野外捡到了羽羽！有了羽羽的帮助，挖矿的效率提升了！")
				yumao=1;
				localStorage.yumao=yumao;
				hide_show();
			}

			if((Math.random()*100)<((Math.log10(0.05*Lv)*5))){//初始0，随等级上升，每10级为10%。100级20%

				if(coal_total>maoqiu_time && Math.random()<0.3){//30%打毛球
					if (maoqiu_flag==0){
						maoqiu();//触发maoqiu战
					}

				}else {
					writeLogOl("你疯狂挖矿惹到周边的小动物");
					meiqiu(); //触发煤球战
				}

				//检测到战斗，弹出界面
				hide_show();
			}
		}
		//探险打怪



		function Getenemy(){

			if (tanxian_flag==0){
				tanxian=setInterval(
        		function (){
        			if(xx_health>=(xx_health_total/8)){

						if(meiqiu_flag==0 || maoqiu_flag ==0){

							if(coal_total>maoqiu_time && Math.random()<0.3){//30%打毛球
								if (maoqiu_flag==0){
									writeLogOl("你四处乱逛、逗猫惹狗~");
									maoqiu();//触发maoqiu战
								}
							}else{
								if(meiqiu_flag==0) {
									writeLogOl("你四处乱逛、逗猫惹狗~");
									meiqiu(); //触发煤球战
								}
							}
						}

					}else if(xx_health<(xx_health_total/10)){
        				writeLogOl("你打不动了，休息一回儿~");
					}
					//检测到战斗，弹出界面
					hide_show();
				},5000 //每5秒检测一次
				);
				document.getElementById('Tanxian').innerHTML = "逛完回家";
				tanxian_flag=1;
			}else {
        		stoptanxian();
        		tanxian_flag=0;
			}
		}
		//关闭自动探险
        function stoptanxian()
		{
            clearInterval(tanxian);
            document.getElementById('Tanxian').innerHTML = "出门乱逛";
        }

		//点升级的按钮逻辑
		//升级表

		var Upcore_refine_flag=0;//核心提炼任务，和启动停止
		function Upcore_refine_building(){

			if(Upcore_refine_task==0){
				if(maoqiukill_num>=(task_maoqiu+10) && xinghuan==1 && coal>=5000 && space_metal>=1000){
					Upcore_refine_task=1;
					localStorage.setItem("Upcore_refine_task", 1);
					writeLogOl("你完成了核心提炼站的修建，开启提炼站每10秒消耗"+0.5*Lv*Lv+"岚星晶矿，提炼1单位升级核心");
					document.getElementById("Upcore_refine_button").value="提炼核心"

				}else{
					writeLogOl("你需要收集10只毛球的能量核，并在星幻的帮助下，消耗5000岚星晶矿和1000星空结晶来完成建设。")
				}

			}else {
				if (Upcore_refine_flag==0){
					if((10000-100*game_round)>1000){
						Upcore_refine_timer=(10000-100*game_round)
					}else {
						Upcore_refine_timer=1000;
					}


					Upcore_refine=setInterval(
					function (){
						if(coal >0.5*Lv*Lv && space_metal>0.1*Lv*Lv){

							Upcore++;
							coal-=Math.ceil(0.5*Lv*Lv);
							space_metal-=Math.ceil(0.1*Lv*Lv)
							Up_power();

						}else {
							writeLogOl("矿物不足，提炼升级核心需要岚星晶矿"+(0.5*Lv*Lv)+"、星空结晶"+(0.1*Lv*Lv));
						}
						//更新数量
						fresh_text();
						hide_show();
					},Upcore_refine_timer //每10秒获取1点升级核心
					);
					document.getElementById('Upcore_refine_button').value = "提炼核心";
					document.getElementById('Upcore_refine_button').className = "button1";
					Upcore_refine_flag=1;

				}else {
					stopUpcore_refine();
					hide_show();
					Upcore_refine_flag=0;
				}
			}
		}

		function stopUpcore_refine()//停止升级核心提炼
		{
            clearInterval(Upcore_refine);
            document.getElementById('Upcore_refine_button').value = "停止提炼";
            document.getElementById('Upcore_refine_button').className = "button_fail";
        }

		//升级飞船
		function Up_power(){

			if (Upcore>=2*Lv) {	//升级所需升级核心的公式为 等级*2

				Upcore-=Lv*2;

				Lv++;//扣除岚星晶矿,提升等级
				xx_health_grow();

				Up_power_event();

				fresh_text();
				writeLogOl("好耶！升级了"+"飞船升到了"+Lv+"级");
				hide_show();
				button_check();

			}

			//yumao==1 && xuemao==1 && changming==1 && daoxue==1 && xx_gundams==1 &&
			// if ( yumao==1 && xuemao==1 && changming==1 && daoxue==1 && xx_gundams==1 && Lv>=100 ){
			// 	var game_end = new $Msg({
			// 		title:"飞向宇宙",
			// 		content:"经过艰苦的努力，你终于修好了飞船\n 在这过程中你还认识了羽毛、长萌、毛球等新的朋友\n 现在你可以飞出大气层开始探索宇宙了\n 你确认要立刻出发吗?",
            // 		confirm:function(){
			// 			if(Defeated>0){
			// 				new $Msg({title:"飞船要起飞了",content:"时候已经到了，你准备好开发太空了\n"+
			// 								"和伙伴们告别的同时，你注意到了远处躲着的煤球好像也对你念念不忘？！"+
			// 								"啊！！！为什么飞船上会藏进来一只毛球呀！！！"});
			//
			//
			// 			}else {
			// 				new $Msg({title:"飞船要起飞了",content:"时候已经到了，你准备开发外太空了\n"+
			// 								"和伙伴们告别的同时，你注意到了远处躲着的煤球和毛球，你挥挥手也向它们告别"});
			// 			}
			//
			// 			hide_show();
			//
            // 		},
			// 		cancle:function(){
			// 			document.getElementById('Save').value = "起飞出发";
			// 			game_round++;
			// 			game_space_choose=0;
			// 		  let cancle = new $Msg({
			// 			title:"欢迎继续游戏",content:"你放弃了立刻出发，继续积攒实力"
			// 		  })
			// 		},
			// 	})
			//
			// }

		}

		function Up_power_event(){

			if(fengshi==0 && tongxunzhan==1){
					writeLogOl("从宇宙中传来电波，你接到了风逝的电话！！！")
					writeLogOl("在风逝的指导下，你将获得了先进科技！")
				new $Msg({
					title:"先进科技！",
					content:"从宇宙中传来电波，你又接到了风逝的电话！！！在风逝的指导下，你将获得了先进科技！飞船设施升级将带来额外属性提升。"
				})
					fengshi=1;
					localStorage.fengshi=fengshi;
					hide_show();
			}

			if(xiaoxiao==1 && Lv==5){
				writeLogOl("筱皛发现了废弃的遗迹设施，获得岚星晶矿+500");
				new $Msg({
					title:"发现遗迹！",
					content:"筱皛发现了废弃的遗迹设施，获得岚星晶矿+500"
				})
				coal+=500;
			}

			if(changming==1 && xiaoxiao==1 && Lv==10){
				writeLogOl("长明帮助你拆解了废弃设施，获得技能点+10");
				new $Msg({
					title:"变废为宝！",
					content:"长明帮助你拆解了废弃设施，获得技能点+10"
				})
				skillpoint=parseFloat(localStorage.skillpoint);
				skillpoint_total=parseFloat(localStorage.skillpoint_total);

				skillpoint=skillpoint+10;
				skillpoint_total=skillpoint_total+10;

				localStorage.skillpoint_total = skillpoint_total;
				localStorage.skillpoint = skillpoint;
			}
			if(fengshi==1 && daoxue==0 && Lv>20){
					writeLogOl("从宇宙中传来电波，你又接到了风逝的电话！！！")
					writeLogOl("风逝帮你改造了飞船，你可以摇人了！！！（道雪的支援到来了）")
				new $Msg({
					title:"道雪支援",
					content:"从宇宙中传来电波，你又接到了风逝的电话！！！风逝帮你改造了飞船，你可以摇人了！！！（道雪的支援到来了）"
				})
					daoxue=1;
					localStorage.daoxue=daoxue;
					hide_show();
			}

			if(Lv>=30 && damaoxian==0){
				damaoxian=1;
				localStorage.damaoxian=1;
				new $Msg({
					title:"赏金任务！",
					content:"你的名号已经渐渐传开了，开始有组织希望借用你的力量了。开启赏金任务战斗，赏金任务可以通过通讯站进行接取。每个时段只能完成一次赏金任务。完成任务可以获得大量报酬。"
				})
				hide_show();
			}

			if(Lv>=40 && lingyu==0){
				writeLogOl("你遇见了泠鱼，泠鱼提供了护卫");

				lingyu=1;
				localStorage.lingyu=1;
				space_metal+=500;
				get_equipment();

				fresh_text();
				button_check();
				hide_show();
			}

			if(Lv>=100 && tongxunzhan>0 && lvling==0){
				writeLogOl("风逝安排了律灵前来支援");
				lvling=1;
				localStorage.lvling=lvling;
				task_maoqiu=localStorage.maoqiukill_num;
				localStorage.task_maoqiu=task_maoqiu;
				document.getElementById("Upcore_refine_button").value="建设核心提炼站"
				new $Msg({
					title:"核心提炼站建设",
					content:"律灵带来了升级核心提炼站的建设方案：你需要收集10只毛球的能量核，并在星幻的帮助下，消耗5000岚星晶矿和1000星空结晶来完成建设。"
				})
				}

			if (fengshi==1 && game_space_choose==0 && Lv>=50){
				game_space_choose=1; //开放星空阶段
				localStorage.game_space_choose=1;
				new $Msg({
					title:"近地轨道建设",
					content:"现在通过在近地轨道建设空间采集设施来建设新的装备"
				})
				writeLogOl("开放了近地轨道建设系统")
				writeLogOl("开放了护卫设施建设")

				if(localStorage.game_round>0){
					localStorage.space_gain_station=localStorage.game_round*5;
					writeLogOl("你发现了不知谁留下的"+localStorage.space_gain_station+"座星空采集站");
				}

				fresh_text();
				button_check();
				hide_show();
			}
		}

		//采集站建设
		function gain_station_build() {
			if (gain_station<Lv+50){
				if(coal>=gain_station*10+20){
					coal-=gain_station*10+20;
					writeLogOl("建造了采集站，每秒岚星晶矿产量加0.5");
					gain_station++;

					if(gain_station%50==0){
						writeLogOl("采集站建设满足组网要求，每秒岚星晶矿产量增加")
					}

					button_check();
				}else {
					writeLogOl("没法启动设备，需要岚星晶矿"+(gain_station*10+20));
				}
			}else {
				writeLogOl("等级不够，无法负担采集站");
			}
			fresh_text();
		}

		//星空站建设
		function space_station_build(){
			if (space_gain_station<Lv+10){
				if(coal>=gain_station*5+space_gain_station*10){
					coal=coal-gain_station*5+space_gain_station*10;
					writeLogOl("建造了星空采集站，每秒星空结晶产量加0.1");
					space_gain_station++;
					button_check()
				}else {
					writeLogOl("没法启动设备，需要岚星晶矿"+(gain_station*5+space_gain_station*10));
				}
			}else {
				writeLogOl("等级不够，无法负担采集站");
			}
			fresh_text();
		}

		//星空提炼站
		function space_refine_station_build(){
			if (space_refine_station<Math.ceil(gain_station/2)){
				if(coal>=gain_station*5+space_refine_station*10){
					coal=coal-gain_station*5+space_refine_station*10;
					writeLogOl("建造了星空提炼站，每秒消耗1点岚星晶矿提炼0.1点星空结晶");
					space_refine_station++;
					button_check()
				}else {
					writeLogOl("无法建设，需要岚星晶矿"+(gain_station*5+space_refine_station*10));
				}
			}else {
				writeLogOl("矿站不够，无法负担提炼站");
			}
			fresh_text();
		}

		//你的属性 装备
		function yours(){
			if (fengshi==1){
				if (equip1==0){
					xx_attach = (xx_guns+parseInt(localStorage.equip2_att) + (Math.floor(xx_guns/20)*5));
					xx_defend = (xx_shields+parseInt(localStorage.equip2_def) + (Math.floor(xx_shields/20)*5));
					xx_speed = (xx_engines+parseInt(localStorage.equip2_speed) + (Math.floor(xx_engines/20)*5));
					xx_crit = parseInt(localStorage.equip2_crit);
				}else if (equip2==0){
					xx_attach = xx_guns+parseInt(localStorage.equip1_att) + (Math.floor(xx_guns/20)*5);
					xx_defend = xx_shields+parseInt(localStorage.equip1_def) + (Math.floor(xx_shields/20)*5);
					xx_speed = xx_engines+parseInt(localStorage.equip1_speed) + (Math.floor(xx_engines/20)*5);
					xx_crit = parseInt(localStorage.equip1_crit);
				}
			}else {
				if (equip1==0){
					xx_attach = xx_guns+parseInt(localStorage.equip2_att);
					xx_defend = xx_shields+parseInt(localStorage.equip2_def);
					xx_speed = xx_engines+parseInt(localStorage.equip2_speed);
					xx_crit = parseInt(localStorage.equip2_crit);
				}else if (equip2==0){
					xx_attach = xx_guns+parseInt(localStorage.equip1_att);
					xx_defend = xx_shields+parseInt(localStorage.equip1_def);
					xx_speed = xx_engines+parseInt(localStorage.equip1_speed);
					xx_crit = parseInt(localStorage.equip1_crit);
				}
			}

		}


		//你的血量成长
		function xx_health_grow(){
			skillpoint_data=Get_skillpoint(Lv);
			skillpoint=skillpoint_data.skillpoint;
			skillpoint_total=skillpoint_data.skillpoint_total;
			xx_health =  Math.round(Math.pow(Lv,2)*1.5+Lv+100); //注意自动回血，雪喵伤害，升级回血
			xx_health_total=Math.round(Math.pow(Lv,2)*1.5+Lv+100);//总血量
			localStorage.xx_health_total=xx_health_total;//总血量存储
			fresh_text();	//更新文本框中的飞船血量
		}

		//装备的显示
		function equipment_fresh(){
			document.getElementById("Equip1").style.left="";
			document.getElementById("Equip2").style.left="";
			document.getElementById("Equip1_name_fax").innerHTML = localStorage.equip1_name;
			document.getElementById("Equip1_name").innerHTML = localStorage.equip1_name +"+"+ localStorage.equip1_level;
			document.getElementById("Equip1_att").innerHTML = "攻击："+ localStorage.equip1_att;
			document.getElementById("Equip1_def").innerHTML = "防御："+ localStorage.equip1_def;
			document.getElementById("Equip1_speed").innerHTML = "速度："+ localStorage.equip1_speed;
			document.getElementById("Equip1_crit").innerHTML = "暴击："+ localStorage.equip1_crit;

			document.getElementById("Equip2_name_fax").innerHTML = localStorage.equip2_name;
			document.getElementById("Equip2_name").innerHTML = localStorage.equip2_name +"+" + localStorage.equip2_level;
			document.getElementById("Equip2_att").innerHTML = "攻击："+ localStorage.equip2_att;
			document.getElementById("Equip2_def").innerHTML = "防御："+ localStorage.equip2_def;
			document.getElementById("Equip2_speed").innerHTML = "速度："+ localStorage.equip2_speed;
			document.getElementById("Equip2_crit").innerHTML = "暴击："+ localStorage.equip2_crit;

			if (equip1==0){
				equipment_display("equip2");
				document.getElementById("Equip1").className="button_equip_fail";
				document.getElementById("Equip1_name").style.display="";
				document.getElementById("Equip1_att").style.display="none";
				document.getElementById("Equip1_def").style.display="none";
				document.getElementById("Equip1_speed").style.display="none";
				document.getElementById("Equip1_crit").style.display="none";

			}else {
				equipment_display("equip1");
				document.getElementById("Equip1").className="button_equip";
				document.getElementById("Equip1_name").style.display="";
				document.getElementById("Equip1_att").style.display="none";
				document.getElementById("Equip1_def").style.display="none";
				document.getElementById("Equip1_speed").style.display="none";
				document.getElementById("Equip1_crit").style.display="none";
			}
			if (equip2==0){
				equipment_display("equip1");
				document.getElementById("Equip2").className="button_equip_fail";
				document.getElementById("Equip2_name").style.display="";
				document.getElementById("Equip2_att").style.display="none";
				document.getElementById("Equip2_def").style.display="none";
				document.getElementById("Equip2_speed").style.display="none";
				document.getElementById("Equip2_crit").style.display="none";

			}else {
				equipment_display("equip2");
				document.getElementById("Equip2_name").style.display="";
				document.getElementById("Equip2").className="button_equip";
				document.getElementById("Equip2_att").style.display="none";
				document.getElementById("Equip2_def").style.display="none";
				document.getElementById("Equip2_speed").style.display="none";
				document.getElementById("Equip2_crit").style.display="none";
			}

			if (localStorage.equip2_type==0){
				document.getElementById("Equip2").style.borderColor="#fff4f4";
			}else if(localStorage.equip2_type==1){
				document.getElementById("Equip2").style.borderColor="#ceff8a";
			}else if(localStorage.equip2_type==2){
				document.getElementById("Equip2").style.borderColor="#ff8ae6";
			}else if(localStorage.equip2_type==3){
				document.getElementById("Equip2").style.borderColor="#ffe140";
			}
			if (localStorage.equip1_type==0){
				document.getElementById("Equip1").style.borderColor="#fff4f4";
			}else if(localStorage.equip1_type==1){
				document.getElementById("Equip1").style.borderColor="#ceff8a";
			}else if(localStorage.equip1_type==2){
				document.getElementById("Equip1").style.borderColor="#ff8ae6";
			}else if(localStorage.equip1_type==3){
				document.getElementById("Equip1").style.borderColor="#ffe140";
			}

		}

		function equipment_display(equip_num){
			var front=equip_num;

			ls_type=eval("localStorage."+(front+"_type"));
			ls_att=eval("localStorage."+(front+"_att"));
			ls_def=eval("localStorage."+(front+"_def"));
			ls_speed=eval("localStorage."+(front+"_speed"));
			ls_crit=eval("localStorage."+(front+"_crit"));
			ls_name=eval("localStorage."+(front+"_name"));

			document.getElementById("Equip_att").innerHTML = "攻击："+ ls_att;
			document.getElementById("Equip_def").innerHTML = "防御："+ ls_def;
			document.getElementById("Equip_speed").innerHTML = "速度："+ ls_speed;
			document.getElementById("Equip_crit").innerHTML = "暴击："+ ls_crit;

			if (ls_type==0){
				document.getElementById("Equip_display").style.borderColor="#fff4f4";
			}else if(ls_type==1){
				document.getElementById("Equip_display").style.borderColor="#ceff8a";
			}else if(ls_type==2){
				document.getElementById("Equip_display").style.borderColor="#ff8ae6";
			}else if(ls_type==3){
				document.getElementById("Equip_display").style.borderColor="#ffe140";
			}

		}

		//装备的鼠标悬停显示
		function show_equipment1(){

			document.getElementById("Equip1_name").style.display="none";

			document.getElementById("Equip1_att").style.display="inline-grid";
			document.getElementById("Equip1_def").style.display="inline-grid";
			document.getElementById("Equip1_speed").style.display="inline-grid";
			document.getElementById("Equip1_crit").style.display="inline-grid";
		}
		function show_equipment2(){
			let top_left= (getElementViewPosition("equip_list").x+25);
			document.getElementById("Equip2").style.left=top_left+"px";

			document.getElementById("Equip2_name").style.display="none";

			document.getElementById("Equip2_att").style.display="inline-grid";
			document.getElementById("Equip2_def").style.display="inline-grid";
			document.getElementById("Equip2_speed").style.display="inline-grid";
			document.getElementById("Equip2_crit").style.display="inline-grid";
		}

		// 获取元素的绝对位置坐标（像对于浏览器视区左上角）
		function getElementViewPosition(element){

		  //计算x坐标
			  var actualLeft = document.getElementById(element).offsetLeft;
			  var current = document.getElementById(element).offsetParent;
			  while (current !== null){
				actualLeft +=  (current.offsetLeft+current.clientLeft);
				current = current.offsetParent;
			  }
			  if (document.compatMode == "BackCompat"){
				var elementScrollLeft=document.body.scrollLeft;
			  } else {
				var elementScrollLeft=document.documentElement.scrollLeft;
			  }
			  var left = actualLeft - elementScrollLeft;
			  //计算y坐标
			  var actualTop = document.getElementById(element).offsetTop;
			  var current = document.getElementById(element).offsetParent;
			  while (current !== null){
				actualTop += (current.offsetTop+current.clientTop);
				current = current.offsetParent;
			  }
			  if (document.compatMode == "BackCompat"){
				var elementScrollTop=document.body.scrollTop;
			  } else {
				var elementScrollTop=document.documentElement.scrollTop;
			  }
			  var right = actualTop-elementScrollTop;
			  //返回结果
			  return {x: left, y: right}
		}

		//生成随机装备
		var equipment_type=0
		function get_equipment(){

			if(equip1==1){
				equipment_type=localStorage.equip1_type;
			}else if(equip2==1){
				equipment_type=localStorage.equip2_type;
			}
			if (space_metal>10*Lv){
				if(equipment_type==3){
					new $Msg({
						title:"重铸?",
						content:"是否要重铸金色护卫",
						confirm: (function (){build_equipment()}),
					})
				}else {
					build_equipment();
				}
			}else {
				writeLogOl("星空结晶不足"+(10*Lv)+"，不能建造护卫单位")
			}


			// eq_seed=Math.random()*1000;
			// localStorage.eq_seed=eq_seed;
			// Get_equipment(seed,Lv);

			fresh_text();
			button_check();
			hide_show();
		}

		function build_equipment(){
			equipment_PR=Math.random()*10;
			if (equipment_PR<4){
				equipment_type=0; // 40%白色装备
			}else if(equipment_PR<7.5){
					equipment_type=1; // 35%绿色装备
			}else if(equipment_PR<9.5){
				equipment_type=2; // 20%紫色装备
			}else if(equipment_PR<11){
				equipment_type=3; // 5%金色装备
			}
			equipment_value(equipment_type);
			equipment_fresh();
			space_metal-=10*Lv;

		}

		//装备数值
		function equipment_value(type){
			sum = Math.floor(Lv/10)*30;
			var fSumTmp = 0;
			var equip_att=0;
			var equip_def=0;
			var equip_speed=0;
			var equip_crit=0;
			var equip_level=0;
			if (type==0){
				fSumTmp=sum*0.8;
				name_front = "锈蚀的"
			}else if(type==1){
				fSumTmp=sum*0.9;
				name_front = "普通的"
			}else if(type==2){
				fSumTmp=sum;
				name_front = "回火的"
			}else if(type==3){
				fSumTmp=sum*1.1;
				name_front = "平衡的"
			}

			i=Math.random()*100;

			if(i<50){
				equip_level=0;
			}else if(i<70){
				equip_level=1;
			}else if(i<85){
				equip_level=2;
			}else if(i<101){
				equip_level=3;
			}

			fSumTmp=fSumTmp+equip_level*3;

			var arr  = new Array(4).fill(0);
			for(var value_idx=0;value_idx<fSumTmp;value_idx++){
				i = parseInt(Math.random()*4)
				arr[i] ++
			}
			equip_att=arr[0];
			equip_def=arr[1];
			equip_speed=arr[2];
			equip_crit=arr[3];

			name_id=Math.round(Math.random()*(equip_names.length-1));

			if (equip1==1){
				localStorage.equip1_type = equipment_type;
				localStorage.equip1_level = equip_level;
				localStorage.equip1_att = equip_att;
				localStorage.equip1_def = equip_def;
				localStorage.equip1_speed = equip_speed;
				localStorage.equip1_crit = equip_crit;
				localStorage.equip1_name = name_front + equip_names[name_id];
				writeLogOl("赌剑呀！你抽到了"+localStorage.equip1_name)
				equipment_fresh();

			}
			else if (equip2==1){
				localStorage.equip2_type = equipment_type;
				localStorage.equip2_level = equip_level;
				localStorage.equip2_att = equip_att;
				localStorage.equip2_def = equip_def;
				localStorage.equip2_speed = equip_speed;
				localStorage.equip2_crit = equip_crit;
				localStorage.equip2_name = name_front + equip_names[name_id];
				writeLogOl("赌剑呀！你抽到了"+localStorage.equip2_name)
				equipment_fresh();
			}
		}
		function Equipment_up_button(){
			if(equip2==1){
				if(window.event.ctrlKey){
					Equipment_up("2");
					Equipment_up("2");
					Equipment_up("2");
					Equipment_up("2");
					Equipment_up("2");

					Equipment_up("2");
					Equipment_up("2");
					Equipment_up("2");
					Equipment_up("2");
					Equipment_up("2");
				}else {
					Equipment_up("2");
				}

			}
			if(equip1==1){
				if(window.event.ctrlKey){
					Equipment_up("1");
					Equipment_up("1");
					Equipment_up("1");
					Equipment_up("1");
					Equipment_up("1");

					Equipment_up("1");
					Equipment_up("1");
					Equipment_up("1");
					Equipment_up("1");
					Equipment_up("1");
				}else {
					Equipment_up("1");
				}

			}
		}

		function Equipment_up(front_){

			e_l="equip"+front_+"_level";
			e_a="equip"+front_+"_att";
			e_d="equip"+front_+"_def";
			e_s="equip"+front_+"_speed";
			e_c="equip"+front_+"_crit";
			equip_level=parseFloat(eval("localStorage."+e_l));
			equip_att=parseFloat(eval("localStorage."+e_a));
			equip_def=parseFloat(eval("localStorage."+e_d));
			equip_speed=parseFloat(eval("localStorage."+e_s));
			equip_crit=parseFloat(eval("localStorage."+e_c));

			if (equip_level<=14){
				if(coal>10*Lv){
					coal-=10*Lv;
					if((Math.random()*15)>equip_level){
						equip_level+=1;
						writeLogOl("强化成功，护卫等级+1~");

						fSumTmp=3;

						var arr  = new Array(4).fill(0);
						for(var value_idx=0;value_idx<fSumTmp;value_idx++){
							i = parseInt(Math.random()*4)
							arr[i] ++
						}
						equip_att+=arr[0];
						equip_def+=arr[1];
						equip_speed+=arr[2];
						equip_crit+=arr[3];

					}else {
						writeLogOl("强化失败qaq");
					}
				}else {
					writeLogOl("素材不足，需要岚星晶矿"+(10*Lv));
				}
			}else {
				writeLogOl("该装备已经不能再强化");
			}
			localStorage.setItem(e_l, equip_level);
			localStorage.setItem(e_a, equip_att);
			localStorage.setItem(e_d, equip_def);
			localStorage.setItem(e_s, equip_speed);
			localStorage.setItem(e_c, equip_crit);
			equipment_fresh();
		}

		//你的武器
		function xxguns(){

				skillpoint-=1;
				localStorage.skillpoint-=1;
				xx_guns++;
				if(changxi==0){
					changxi=1;
					hide_show();
					fresh_text();
				}
				gun_idx=Math.floor(xx_guns/20);
					if (gun_idx>gun_names.length-1){
						gun_idx=gun_names.length-1;
					}
					gun_name=gun_names[gun_idx];

				if (fengshi==1){
					if(xx_guns==20){
						writeLogOl("滴滴滴，常曦支援了新的武器系统，攻击+5");
						new $Msg({title:"通讯：武器升级",
							content:"滴滴滴，常曦支援了新的武器系统，攻击+5"});

					}else if(xx_guns==40){
						writeLogOl("滴滴滴，常曦支援了新的武器系统，攻击+5");
						new $Msg({title:"通讯：武器升级",
							content:"滴滴滴，常曦支援了新的武器系统，攻击+5"});

					}
					else if(xx_guns==60){
						writeLogOl("滴滴滴，常曦支援了新的武器系统，攻击+5");
						new $Msg({title:"通讯：武器升级",
							content:"滴滴滴，常曦支援了新的武器系统，攻击+5"});

					}else if(xx_guns==80){
						writeLogOl("滴滴滴，常曦支援了新的武器系统，攻击+5");
						new $Msg({title:"通讯：武器升级",
							content:"滴滴滴，常曦支援了新的武器系统，攻击+5"});

					}else if(xx_guns==100){
						writeLogOl("滴滴滴，常曦支援了新的武器系统，攻击+5");
						new $Msg({title:"通讯：武器升级",
							content:"滴滴滴，常曦支援了新的武器系统，攻击+5"});

					}else if(xx_guns==120){
						writeLogOl("滴滴滴，常曦支援了新的武器系统，攻击+5");
						new $Msg({title:"通讯：武器升级",
							content:"滴滴滴，常曦支援了新的武器系统，攻击+5"});

					}else if(xx_guns==140){
						writeLogOl("滴滴滴，常曦支援了新的武器系统，攻击+5");
						new $Msg({title:"通讯：武器升级",
							content:"滴滴滴，常曦支援了新的武器系统，攻击+5"});

					}
				}

				writeLogOl("你建造了"+gun_name+"，攻击+1");
		}

		function xxshields(){

				xx_shields++;
				skillpoint-=1;
				localStorage.skillpoint-=1;
				if (fengshi==1){
					if(youzi==0){
						youzi=1;
						hide_show();
						fresh_text();
					}

					shield_idx=Math.floor(xx_shields/20);
					if (shield_idx>shield_names.length-1){
						shield_idx=shield_names.length-1;
					}
					shield_name=shield_names[shield_idx];

					if(xx_shields==20){
						writeLogOl("滴滴滴，柚子支援了新的护盾资料，防御+5");
						new $Msg({title:"通讯：防护升级",
							content:"滴滴滴，柚子支援了新的护盾资料，防御+5"});

					}else if(xx_shields==40){
						writeLogOl("滴滴滴，柚子支援了新的护盾资料，防御+5");
						new $Msg({title:"通讯：防护升级",
							content:"滴滴滴，柚子支援了新的护盾资料，防御+5"});


					}else if(xx_shields==60){
						writeLogOl("滴滴滴，柚子支援了新的护盾资料，防御+5");
						new $Msg({title:"通讯：防护升级",
							content:"滴滴滴，柚子支援了新的护盾资料，防御+5"});


					}else if(xx_shields==80){
						writeLogOl("滴滴滴，柚子支援了新的护盾资料，防御+5");
						new $Msg({title:"通讯：防护升级",
							content:"滴滴滴，柚子支援了新护盾资料，防御+5"});

					}else if(xx_shields==100){
						writeLogOl("滴滴滴，柚子支援了新的护盾资料，防御+5");
						new $Msg({title:"通讯：防护升级",
							content:"滴滴滴，柚子支援了新的护盾资料，防御+5"});


					}else if(xx_shields==120){
						writeLogOl("滴滴滴，柚子支援了新的护盾资料，防御+5");
						new $Msg({title:"通讯：防护升级",
							content:"滴滴滴，柚子支援了新的护盾资料，防御+5"});


					}else if(xx_shields==140){
						writeLogOl("滴滴滴，柚子支援了新的护盾资料，防御+5");
						new $Msg({title:"通讯：防护升级",
							content:"滴滴滴，柚子支援了新的护盾资料，防御+5"});


					}

				}
				writeLogOl("你升级了"+shield_name+"，防御+1");

		}
		function xxengines(){
			skillpoint-=1;
			xx_engines++;
			localStorage.skillpoint-=1;
			if(fengshi==1) {
				if(hexian==0){
					hexian=1;
					hide_show();
					fresh_text();
				}
				engine_idx=Math.floor(xx_engines/20);
				if (engine_idx>engine_names.length-1){
					engine_idx=engine_names.length-1;
				}
				engine_name=engine_names[engine_idx];

				if (xx_engines == 20) {
						writeLogOl("滴滴滴，和弦支援了新的飞行系统，速度+5");
						new $Msg({title:"通讯：引擎升级",
							content:"滴滴滴，和弦支援了新的飞行系统，速度+5"});


				} else if (xx_engines == 40) {
						writeLogOl("滴滴滴，和弦支援了新的飞行系统，速度+5");
						new $Msg({title:"通讯：引擎升级",
							content:"滴滴滴，和弦支援了新的飞行系统，速度+5"});


				} else if (xx_engines == 60) {
						writeLogOl("滴滴滴，和弦支援了新的飞行系统，速度+5");
						new $Msg({title:"通讯：引擎升级",
							content:"滴滴滴，和弦支援了新的飞行系统，速度+5"});


				} else if (xx_engines == 80) {
						writeLogOl("滴滴滴，和弦支援了新的飞行系统，速度+5");
						new $Msg({title:"通讯：引擎升级",
							content:"滴滴滴，和弦支援了新的飞行系统，速度+5"});


				} else if (xx_engines == 100) {
						writeLogOl("滴滴滴，和弦支援了新的飞行系统，速度+5");
						new $Msg({title:"通讯：引擎升级",
							content:"滴滴滴，和弦支援了新的飞行系统，速度+5"});


				} else if (xx_engines == 120) {
						writeLogOl("滴滴滴，和弦支援了新的飞行系统，速度+5");
						new $Msg({title:"通讯：引擎升级",
							content:"滴滴滴，和弦支援了新的飞行系统，速度+5"});


				} else if (xx_engines == 140) {
						writeLogOl("滴滴滴，和弦支援了新的飞行系统，速度+5");
						new $Msg({title:"通讯：引擎升级",
							content:"滴滴滴，和弦支援了新的飞行系统，速度+5"});


				}
			}

			writeLogOl("你升级了"+engine_name+"，速度+1");

		}

		//点击升级护盾
		function shields_button(){
			var obj = document.getElementsByName("skill_button_radio");
			for(var i=0; i<obj.length; i ++){
				if(obj[i].checked){
					num=parseFloat(obj[i].value);
				}
			}

			if (skillpoint>0){

				if(xx_gundams==0 && Math.random()>0.99){
					get_gundams();
				}
				if(window.event.ctrlKey || num==10){
					if(skillpoint>=10){
						xxshields();
						xxshields();
						xxshields();
						xxshields();
						xxshields();

						xxshields();
						xxshields();
						xxshields();
						xxshields();
						xxshields();
					}else {
						writeLogOl("升级点不足，升级飞船可以获得升级点");
					}

				}else {
					xxshields();
				}

				fresh_text();
				button_check();

			}else {//岚星晶矿不足报错
				writeLogOl("升级点不足，升级飞船可以获得升级点");
			}
		}

		//点击升级武器
		function guns_button(){
			var obj = document.getElementsByName("skill_button_radio");
			for(var i=0; i<obj.length; i ++){
				if(obj[i].checked){
					num=parseFloat(obj[i].value);
				}
			}

			if (skillpoint>0){

				if(xx_gundams==0 && Math.random()>0.99){
					get_gundams();
				}
				if(window.event.ctrlKey || num==10){
					if(skillpoint>=10){
						xxguns();
						xxguns();
						xxguns();
						xxguns();
						xxguns();

						xxguns();
						xxguns();
						xxguns();
						xxguns();
						xxguns();
					}else {
						writeLogOl("升级点不足，升级飞船可以获得升级点");
					}

				}else {
					xxguns();
				}

				fresh_text();
				button_check();

			}else {//不足报错
				writeLogOl("升级点不足，升级飞船可以获得升级点");
			}
		}
		function get_gundams(){
			writeLogOl("你灵机一动，造出了高达！！！")
			writeLogOl("高达加入了战斗队列")
			new $Msg({title:"高达!?",
				content:"你灵机一动，造出了高达！！！高达将帮助你战斗"});
			xx_gundams=1;
			localStorage.xx_gundams=xx_gundams;
			hide_show();
		}

		//点击升级引擎
		function engines_button(){
			var obj = document.getElementsByName("skill_button_radio");
			for(var i=0; i<obj.length; i ++){
				if(obj[i].checked){
					num=parseFloat(obj[i].value);
				}
			}

			if (skillpoint>0){

				if(xx_gundams==0 && Math.random()>0.99){
					get_gundams();

				}
				if(window.event.ctrlKey || num==10){
					if(skillpoint>=10){
						xxengines();
						xxengines();
						xxengines();
						xxengines();
						xxengines();

						xxengines();
						xxengines();
						xxengines();
						xxengines();
						xxengines();
					}else {
						writeLogOl("升级点不足，升级飞船可以获得升级点");
					}

				}else {
					xxengines();
				}

				fresh_text();
				button_check();

			}else {//升级点不足
				writeLogOl("升级点不足，升级飞船可以获得升级点");
			}
		}
		function Get_dayboss(){
			var day_seed=$Gettime().year + $Gettime().mon + $Gettime().day+ $Gettime().h;


			if (day_seed!=localStorage.dayboss_seed){
				dayboss_victory=0;
				localStorage.dayboss_data_lifenum=10;
			}

			if (dayboss_victory==0){
				if (dayboss_flag==0){
					dayboss_data=Getdayboss(Lv,day_seed);
					dayboss_flag=1;
					writeLogOl("你接到到了悬赏任务，消灭盘踞在岚星的"+dayboss_data.name);
					Daybossdisplay(dayboss_data);
					document.getElementById("Dayboss_health").innerHTML=num_change(dayboss_data.health.toFixed(0));
					localStorage.dayboss_name=dayboss_data.name;
				}else {
					writeLogOl("没法接取额外的赏金任务，你被"+localStorage.dayboss_name+"纠缠住了");
				}

			}else {
				writeLogOl("你打败了该时段的赏金敌人");
			}

			fresh_text();
			hide_show();

		}

		//最终毛球的属性
		function maoqiu(){
			// 预设566触发
			maoqiu_flag=1;
			maoqiudata=Getmaoqiu(Lv);
			maoqiu_health = maoqiudata.health;
			maoqiu_attach = maoqiudata.attach;
			maoqiu_defend = maoqiudata.defend;
			maoqiu_speed = maoqiudata.speed;
			maoqiu_crit = maoqiudata.crit;
			maoqiu_name=maoqiudata.name;

			writeLogOl("轰隆隆...砰砰! 好像有什么响声？发生了什么");
			writeLogOl("嗷呜~~~~! 哐砰哗啦叮咚噼里啪啦！");
			writeLogOl("你疯狂折腾的行为惊动了霸主"+maoqiu_name+"！！！大危机！！！");

			Maoqiudisplay(maoqiu_name,maoqiu_attach,maoqiu_defend,maoqiu_speed,maoqiu_crit);

			fresh_text();	//更新文本框中的毛球的血量
			hide_show();
		}

		//煤球的属性
		function meiqiu(){


			meiqiu_flag=1;

			meiqiu_data=Get_meiqiu(Lv);

			writeLogOl("不好! 你遇见了抢矿的"+meiqiu_data.meiqiu_name+"！")

			Meiqiudisplay(meiqiu_data.meiqiu_name, meiqiu_data.meiqiu_attach,meiqiu_data.meiqiu_defend,meiqiu_data.meiqiu_speed,meiqiu_data.meiqiu_crit);

			fresh_text();	//更新文本框中的飞船血量
			hide_show();
		}

		function save_gugu(){
			writeLogOl("在与煤球斗智斗勇的过程中，你拯救了在矿洞中迷路的白鸽咕咕！");
			writeLogOl("咕咕向你提供了迷路时记录的地图，自动遇见煤球的概率极大下降了！");
			gugu=1;
			localStorage.gugu=gugu;
			PR_meiqiu=0.999;

			fresh_text();
		}

		//maoqiu自动战斗
		var mao_t=0;
		function maoqiu_fight(){
			fight_data=fight_( maoqiu_health,xx_health,maoqiu_attach,xx_defend,maoqiu_speed,xx_speed,maoqiu_crit);//攻击者血, 防御者血,攻击者攻击值，防御者防御值，攻击者速度，防御者速度

			if(mao_t>=5){
				if(Math.random()>0.8){
					health_loss=Math.ceil((xx_health/2) * (Math.random()+0.1));
					xx_health-=health_loss;
					writeLogOl02("毛球对你发动了一次无法防御的攻击，造成了"+health_loss+"点伤害","orange");
					mao_t=0;
				}
			}else{
				if (Math.random()>0.9){
					mao_t++;
					writeLogOl02("毛球在观察你的弱点！"+mao_t+"/5");
					if (mao_t==5){
					writeLogOl02("警告！警告！敌锁定！敌锁定！","orange");
					}
				}
			}

			health_loss=fight_data.health_loss;
			if (fight_data.attached==0){
				writeLogOl02("毛球攻击了你，但是被你预判了，未造成伤害","#e2b8fc");
			}else {
				if(fight_data.crited==1){
					if(fight_data.defended==1){
						xx_health-= health_loss
						writeLogOl02("毛球打出了暴击！造成了"+health_loss+"伤害","#b649ff");
					}else {
						xx_health-= Math.ceil(health_loss/5)
						writeLogOl02("毛球打出了暴击！但是被你挡住了，造成了"+Math.ceil(health_loss/5)+"伤害","#7e7eff");
					}
				}else {
					if(fight_data.defended==1){
						xx_health-= health_loss
						writeLogOl02("毛球攻击了你！造成了"+health_loss+"伤害","#dbaaff");
					}else {
						xx_health-= Math.ceil(health_loss/5)
						writeLogOl02("毛球攻击了你！但是被你挡住了，造成了"+Math.ceil(health_loss/5)+"伤害","#dbaaff");
					}
				}
			}


			if (xx_health<0){
					xx_health=-1;
			}
			fresh_text(); //更新飞船血量
		}

		//小怪自动战斗
		function meiqiu_fight(){
			fight_data=fight_( meiqiu_data.meiqiu_health,xx_health,meiqiu_data.meiqiu_attach,xx_defend,meiqiu_data.meiqiu_speed,xx_speed,meiqiu_data.meiqiu_crit);//攻击者血,  防御者血,攻击者攻击值，防御者防御值，攻击者速度，防御者速度
			health_loss=fight_data.health_loss;
			if (fight_data.attached==0){
				writeLogOl02(meiqiu_data.meiqiu_name+"攻击了你，但是没有命中","#b9bee7");
			}else {
				if(fight_data.crited==1){
					if(fight_data.defended==1){
						xx_health-= health_loss
						writeLogOl02(meiqiu_data.meiqiu_name+"打出了暴击！造成了"+health_loss+"伤害","#394fec");
					}else {
						xx_health-= Math.ceil(health_loss/5)
						writeLogOl02(meiqiu_data.meiqiu_name+"打出了暴击！但是被你挡住了，造成了"+Math.ceil(health_loss/5)+"伤害","#6a7fff");
					}
				}else {
					if(fight_data.defended==1){
						xx_health-= health_loss
						writeLogOl02(meiqiu_data.meiqiu_name+"攻击了你！造成了"+health_loss+"伤害","#6473ea");
					}else {
						xx_health-= Math.ceil(health_loss/5)
						writeLogOl02(meiqiu_data.meiqiu_name+"攻击了你！但是被你挡住了，造成了"+Math.ceil(health_loss/5)+"伤害","#6473ea");
					}
				}
			}

			if (xx_health<0){
					xx_health=-1;
			}
			fresh_text(); //更新飞船血量
		}

		//修复按钮
		function repair(){
			if(xx_health<xx_health_total){
				if(coal>Math.ceil(xx_health_total/200)){
					xx_health+=Math.ceil(xx_health_total/200);
					coal-=Math.ceil(xx_health_total/200);
				}else {
					writeLogOl02("晶矿不足，无法修复","#aa2f2f")
				}
			}
			fresh_text();
		}

		//撤退按钮
		function escape(){
			delt_speed_maoqiu=xx_speed-maoqiu_speed;
			delt_speed_meiqiu=xx_speed-meiqiu_data.meiqiu_speed;

			if(maoqiu_flag==1){
				if(delt_speed_maoqiu>0){
					maoqiu_flag=0;
					writeLogOl02("你凭借优秀的速度甩开了毛球，成功跑路");
					coal=coal-Math.floor(0.5*gain_station);	//岚星晶矿丢失
					if (coal<0){//避免负数
						coal=0;
					}
					writeLogOl("风紧扯呼————你甩开毛球跑路了");
					writeLogOl("好可怕! 你逃走的时候遗失了岚星晶矿 "+(Math.floor(0.5*gain_station)))
				}else if(coal>(10*Lv+5)){
					maoqiu_flag=0;
					writeLogOl02("风紧扯呼————");
					writeLogOl("风紧扯呼————你丢下一包岚星晶矿跑路了");
					coal-=Math.round(10*Lv+5);
					writeLogOl("损失岚星晶矿"+(10*Lv+5));
				}else {
					writeLogOl02("逃跑失败了，毛球识破了你的伎俩");
				}

			}

			if(meiqiu_flag==1){
				if(delt_speed_meiqiu>0){
					meiqiu_flag=0;
					writeLogOl02("你凭借优秀的速度甩开了"+meiqiu_data.meiqiu_name+"，成功跑路");
					coal=coal-Math.floor(0.5*gain_station);	//岚星晶矿丢失
					if (coal<0){//避免负数
						coal=0;
					}
					writeLogOl("风紧扯呼————你甩开毛球跑路了");
					writeLogOl("好可怕! 你逃走的时候遗失了岚星晶矿 "+(Math.floor(0.5*gain_station)))
				}else if(coal>(10*Lv+5)){
					meiqiu_flag=0;
					writeLogOl02("风紧扯呼————");
					writeLogOl("风紧扯呼————你丢下一包岚星晶矿跑路了");
					coal-=Math.round(10*Lv+5);
					writeLogOl("损失岚星晶矿"+(10*Lv+5));
				}else {
					writeLogOl02("逃跑失败了，对手识破了你的伎俩");
				}
			}

			if(dayboss_flag==1){
				dayboss_flag=0;
				writeLogOl02("点子扎手，撤退————");
				coal=coal-Math.round(10*Lv+5);	//岚星晶矿丢失
				if (coal<0){//避免负数
					coal=0;
				}
				writeLogOl("你丢下"+(10*Lv+5)+"岚星晶矿撤退了，"+dayboss_data.name+"没有来追你");
			}


			fresh_text();
			hide_show();
			button_check();
		}

		//打他按键
		function fight(){
			if (maoqiu_flag>0){
				health_loss=your_fight().health_loss_maoqiu;
				health_loss.health_loss=Math.ceil(health_loss.health_loss/2)
				maoqiu_health-= health_loss.health_loss;
				writeyourfightlog("你","maoqiu",health_loss);
				Xuemaofight();
				if (maoqiu_health<0){
				maoqiu_health=-1;
				fresh_text();
				}
				fight_end();
				//战胜结算
			}

			if (meiqiu_flag>0){
				health_loss=your_fight().health_loss_meiqiu;
				health_loss.health_loss=Math.ceil(health_loss.health_loss/2)
				meiqiu_data.meiqiu_health-= health_loss.health_loss;
				writeyourfightlog("你","meiqiu",health_loss);
				Xuemaofight();
				if (meiqiu_data.meiqiu_health<0){
				meiqiu_data.meiqiu_health=-1;
				fresh_text();
				}
				fight_end();
				//战胜结算
			}

			if (dayboss_victory==0&&dayboss_flag==1){
				health_loss=fight_(xx_health,xx_health, xx_attach, dayboss_data.def, xx_speed,dayboss_data.speed,xx_crit);
				health_loss.health_loss=Math.ceil(health_loss.health_loss);
				dayboss_data.health-= health_loss.health_loss;
				writeyourfightlog("你","dayboss",health_loss);
				Xuemaofight();
				if (dayboss_data.health<0){
				dayboss_data.health=-1;
				}
				fresh_text();
				fight_end();
			}

			fresh_text();//更新文本框中的血量
		}

		function Xuemaofight(){
					//触发技能雪喵
			if(Math.random()>0.95){
				xuemaoatt=Math.round((xx_health_total/2)*(Math.random()*0.5)); //0.5到1.5倍的1/2等级血量伤害
				writeLogOl02("说时迟，那时快！草丛里跳出来了雪喵！","orange");
				writeLogOl02("雪喵狠狠地给了敌人一棍，造成了"+xuemaoatt+'伤害！',"orange");
				meiqiu_data.meiqiu_health=meiqiu_data.meiqiu_health-xuemaoatt;
				if (meiqiu_data.meiqiu_health<0){
					meiqiu_data.meiqiu_health=-1;
				}
				maoqiu_health=maoqiu_health-xuemaoatt;
				if (maoqiu_health<0){
					maoqiu_health=-1;
				}
				xuemao=1;
				localStorage.xuemao=xuemao;
				hide_show();
				fresh_text();
			}
		}

		//道雪打人按钮
		var t=0;
		function Daoxue_fight(){
			if(maoqiu_flag==1 || meiqiu_flag==1 || dayboss_flag==1){
				if(coal>(5*Lv+5)){
					writeLogOl("你请求了支援并支付了酬金"+(5*Lv+30));
					writeLogOl("收到岚星晶矿的道雪开着飞机丢了几块石头下来，沉重的打击了敌人！！！");
					if(dayboss_flag==1){
						dayboss_data.health-=Math.ceil(dayboss_data.health/20);
						writeLogOl02("道雪轰炸了敌人，造成了"+dayboss_data.name+(Math.ceil(dayboss_data.health/20))+"伤害","orange");
					}
					if(maoqiu_flag==1){
						maoqiu_health-=Math.ceil(maoqiu_health/5);
						writeLogOl02("道雪轰炸了敌人，造成了"+maoqiu_name+(Math.ceil(maoqiu_health/5))+"伤害","orange");
					}
					if(meiqiu_flag==1){
						meiqiu_data.meiqiu_health-=Math.ceil(meiqiu_data.meiqiu_health/5);
						writeLogOl02("道雪轰炸了敌人，造成了"+meiqiu_data.meiqiu_name+(Math.ceil(meiqiu_data.meiqiu_health/5))+"伤害","orange");
					}

				coal-=(5*Lv+30);
				hide_show();
				fresh_text();
				fight_end();

				}else {
					writeLogOl("道雪表示：得加钱，至少要"+(5*Lv+30)+"这个数");
				}

			}else {

				t=t+1;
				if (t<2){
					writeLogOl("当前并没有敌人，不过道雪表示：如果你愿意给钱的话，她也很开心地收下");
				}

				if(t==2){
					writeLogOl("对于你上贡的积极，道雪很满意，但还是拒绝了");
				}

				if(t==3){
					writeLogOl("道雪喜不胜收，但还是拒绝了");
				}

				if (t>3){
					writeLogOl("三辞三让后，道雪开心地收下了贡品");
					writeLogOl("岚星晶矿-"+(5*Lv+30));
					coal-=(5*Lv+30);
					t=0;
					fresh_text();
				}
			}

		}
		//你自动战斗

		function your_fight(){

			if (meiqiu_flag==1){
				var health_loss_meiqiu=fight_(xx_health,meiqiu_data.meiqiu_health, xx_attach, meiqiu_data.meiqiu_defend, xx_speed,meiqiu_data.meiqiu_speed,xx_crit);//攻击者血,  防御者血,攻击者攻击值，防御者防御值，攻击者速度，防御者速度
			}
			if(maoqiu_flag==1){
				var health_loss_maoqiu=fight_(xx_health,maoqiu_health, xx_attach, maoqiu_defend, xx_speed,maoqiu_speed,xx_crit);//攻击者血,  防御者血,攻击者攻击值，防御者防御值，攻击者速度，防御者速度
			}
			return {health_loss_meiqiu:health_loss_meiqiu,health_loss_maoqiu:health_loss_maoqiu}
		}

		//战斗
		function fight_(att_health,def_health, attach, defend, att_speed, def_speed, att_crit){//攻击者血, 防御者血,攻击者攻击值，防御者防御值，攻击者速度，防御者速度

			fightspeed=Math.floor((1+Math.random())*att_speed);
			defspeed=Math.floor((1+Math.random())*def_speed);
			delt_speed=fightspeed-defspeed;
			def_speed=0.05*(delt_speed+20);
			def_speed=Math.pow(Math.E,-def_speed);
			PRspeed=100/(1+def_speed);
			PRcrit= att_crit/100;
			var health_loss=0;

			fightattach = 0.01*att_health+Math.floor((Math.random())*attach+attach);

			fightdefend = 0.01*def_health + Math.floor((Math.random())*defend+defend);

			if (((Math.random()*100)+10)<=PRspeed){	//sigmoid函数速度差决定概率，速度差大于0点命中率大于72%,速度为-64时不命中
				var attached=1//命中
				health_loss = Math.ceil((fightattach-fightdefend));
				//是否被抵挡
				if (health_loss<=0){
						var defended=1//抵挡
						health_loss=Math.ceil(fightattach/10);
						}else {
						var defended=0//未抵挡
						health_loss=Math.ceil(fightattach);
					}
				//是否暴击
				if (Math.random()<=PRcrit){//暴击
					var crited=1 //暴击
					health_loss = Math.ceil(health_loss*Critical_hit_level);	//基础伤害（血量）+随机增伤（受等级影响）-防御减伤
				}else {
					var crited=0 //未暴击
					health_loss = health_loss;//基础伤害（血量）+随机增伤（受等级影响）-防御减伤
				}
			}else{
				var attached=0//未命中
				health_loss = 0;
			}
		return {health_loss:health_loss,attached:attached,defended:defended,crited:crited};
		}

		</script>

		<script>

		</script>

<!--		显示区域         -->
		<div class="row">
<!--	左边栏的内容		-->
			<div class="leftcolumn">
				<div class="card" style=" padding-top: 5px; padding-bottom: 5px; border-radius: 25px; font-size: x-small">

					<form action=" " id= "caiji" name="form1" style="text-align: justify">

						<div id="coaltxt" style=" display:inline-block; width: 30%; text-align: justify">
							<p style="margin-left: 5px" >岚星晶矿：</p>
								<p style="margin-left: 5px" id="coal_txt">
									岚星晶矿数:0
								</p>
						</div>
						<div id="Spacemetal" style="display:none; width: 35%; text-align: justify">
							<p style="margin-left: 5px">星空结晶：</p>
							<p style="margin-left: 5px" id="Spacemetal_txt">
									星空结晶:0
								</p>
						</div>
						<div id="Upcoretex"style=" display:inline-block; width: 30%; text-align: justify">
							<p style="margin-left: 5px">升级核心：</p>
							<p style="margin-left: 5px" id="Upcore_txt">
									升级核心:0
								</p>
						</div>
					</form>

					<form action="" id="space_caiji" name="form2" style="text-align: justify; border-bottom: dotted #66ccff">
						<div style=" display:inline-block;  width: 30%; text-align: justify">
								<p style="margin-left: 5px" id="Gain_station">
									采集站:0
								</p>
						</div>

						<div id="Spacegainstation" style="display:none; width: 30%; text-align: justify">
							<p style="margin-left: 5px" id="Spacegainstation_txt">
									星空采集站:0
								</p>
						</div>
						<div id="Spacerefinestation" style="display:none; width: 30%; text-align: justify">
							<p style="margin-left: 5px" id="Spacerefinestation_txt">
									星空提炼站:0
								</p>
						</div>

					</form>

					<form action="" id="Level" name="your_level" style="text-align:justify ">

						<div id="powertxt" style=" display:inline-block; width: 30%; text-align: justify">
								<p style="margin-left: 5px" id="power_txt">
									等级:0
								</p>
						</div>

						<div id="skillpointtxt" style=" display:inline-block; width: 30%; text-align: justify">
							<p style="margin-left: 5px" id="skillpoint">
								当前升级点：
							</p>

						</div>
						<div id="radio_change_button" style="display: inline-block;">
							<button class="button1" type="button" onclick="show_button_radio()" style=" text-align: justify;">调整加点</button>
						</div>
						<script type="text/javascript">
							function show_button_radio(){
								let top_left= (getElementViewPosition("radio_change_button"));
								document.getElementById("button_radio").style.left=top_left.x+"px";
								document.getElementById("button_radio").style.top=top_left.y+"px";
								document.getElementById("button_radio").style.display="";
							}
							function hide_button_radio(){
								document.getElementById("button_radio").style.display="none";
							}
						</script>

						<div class="PopupWindow" id="button_radio" style="display: none; position: fixed">
							<div style="text-align: right">
								<button type="button" style="border: aliceblue; margin:0px; background-color: aliceblue" onclick="hide_button_radio()">x</button>
							</div>
							<p class="ptxt">选择要使用的加点次数：</p>
							<label style="display: inline-flex; ">
									<input type="radio" name="skill_button_radio" value="1" checked="checked">+1
									<input type="radio" name="skill_button_radio" value="10">+10
							</label>
						</div>


					</form>

					<form action="" id = "equipment" name="your_health" style="text-align: justify">

						<div style=" display:inline-block;  width: 30%; text-align: justify">
							<p style="margin-left: 5px" id="Guns_xx">
								机炮数量:0
							</p>
							<div style=" display:inline-block;   text-align: justify">
								<input class="button_fail" type="button" id="gun_button" value="升级武器" onclick="guns_button()" style="margin-right: 0">
							</div>
						</div>

						<div style=" display:inline-block;  width: 30%; text-align: justify">
							<p style="margin-left: 5px" id="Shields_xx">
								护盾等级:0
							</p>
							<div style=" display:inline-block;   text-align: justify">
								<input class="button_fail" type="button" id="shield_button" value="升级防护" onclick="shields_button()" style="margin-right: 0">
							</div>
						</div>

						<div style=" display:inline-block;  width: 30%; text-align: justify">
							<p style="margin-left: 5px" id="Engine_xx">
								锅炉等级:0
							</p>
							<div style=" display:inline-block;  text-align: justify">
								<input class="button_fail" type="button" id="engine_button" value="升级引擎" onclick="engines_button()" style="margin-right: 0">
							</div>
						</div>

					</form>

					<HR align="left" width="100%"color=#66ccff SIZE=2>

				</div>

				<div class="card" style="padding-top: 0px">

					<form action="" id="buttons" style="display: inline-table">

						<div>
							<via action=" " id= "healing_button" style="">
								<input class="button_fail" type="button" id="heal_button_id" name="heal_button" value="准备修复" onclick="startheal()" />
							</via>

							<via action=" " id= "Upcore_refine_task" style=" display: none">
								<input class="button_fail" type="button" id="Upcore_refine_button" value="核心精炼站" onclick="Upcore_refine_building()" />
							</via>

							<via action=" " id= "tongxunzhan_task" style=" display: none">
								<input class="button_fail" type="button" id="tongxunzhan_button" value="建设通讯站" onclick="tongxunzhan_build()" />
							</via>
<!--							<div style=" display:inline-block;  text-align: justify">-->
<!--								<input class="button1" id="Damaoxian_button" type="button" value="大冒险！" style="display: none" onclick="Get_dayboss()" />-->
<!--							</div>-->
						</div>

						<div>
							<div style=" display:inline-block;  text-align: justify">
								<input class="button1" type="button" name="wajue" value="挖挖晶矿" onclick="Wa_coal()" />
							</div>

							<div style=" display:inline-block;  text-align: justify">
								<input class="button_fail" type="button" id="gain_station_button" value="制造矿站" onclick="gain_station_build()" />
							</div>
							<div id="space_gain_station_button" style=" display:none;  text-align: justify">
								<input class="button_fail" type="button" id="space_gain_station_button_txt" value="星空采集站" onclick="space_station_build()" />
							</div>
							<div id="space_refine_station_button" style=" display:none;  text-align: justify">
								<input class="button_fail" type="button" id="space_refine_station_button_txt" value="星空精炼站" onclick="space_refine_station_build()" />
							</div>
						</div>

					</form>


					<HR align="left" width="100%"color=#66ccff SIZE=2>

					<div style="padding-top: 0px; padding-bottom: 0px; font-size: x-small">

						<ol style="list-style:none;padding:0px;width:80%;height:50px;max-height:50px;overflow-y:hidden; display: inline-block" id="logol">这天，你来到了这个神奇的星球</ol>
						<button class="button1" style="font-size: xx-small; margin:auto; display: inline-table" id="show_eventrecode" onclick="show_eventrecode()">
							展开</button>
						<script type="text/javascript">
							var eventrecode_flag=0;
							function show_eventrecode(){

								if (eventrecode_flag==0){
									document.getElementById("logol").style.width="100%";
									document.getElementById("logol").style.maxHeight="200px";
									document.getElementById("logol").style.height="200px";
									document.getElementById("logol").style.overflowY="auto";
									document.getElementById("show_eventrecode").innerHTML="收起";
									eventrecode_flag=1;
								}else {

									document.getElementById("logol").style.width="80%";
									document.getElementById("logol").style.maxHeight="50px";
									document.getElementById("logol").style.height="50px";
									document.getElementById("logol").style.overflowY="hidden";
									document.getElementById("logol").scrollTop=document.getElementById("logol").scrollHeight;
									document.getElementById("show_eventrecode").innerHTML="展开";
									eventrecode_flag=0;
								}
							}
						</script>
					</div>

					<HR align="left" width="100%"color=#66ccff SIZE=2>

					<form action="" id="Equipbox" style="display: none;">
						<div class="button1" id="Equip_display" style=" border: 3px solid; text-align: center">
							<p class="ptxt" style="display: inline-grid;width: 18%;font-size: x-small">当前护卫:</p>
							<p class="ptxt" id="Equip_att" style="display: inline-grid;width: 19%;font-size: x-small"> 攻击：0 </p>
							<p class="ptxt" id="Equip_def" style="display: inline-grid;width: 19%;font-size: x-small"> 防御：0 </p>
							<p class="ptxt" id="Equip_speed" style="display: inline-grid;width: 19%;font-size: x-small"> 速度：0 </p>
							<p class="ptxt" id="Equip_crit" style="display: inline-grid;width: 16%;font-size: x-small"> 暴击：0 </p>
						</div>
						<div id="equip_list" style="display: inline-flex">
							<div style="margin-right:2em; ">
								<div style="display: inline-grid;position: static">
									<button class="button_equip_fax" type="button" id="Equip1_fax" style="border:5px solid aliceblue; background: aliceblue;display:inline-block;  text-align: justify">
											<p class="ptxt" id="Equip1_name_fax" style="display: inline-grid;font-size: x-small"> 攻击：0 </p>
									</button>
									<button class="button_equip_fail" type="button" id="Equip1" style="display:inline-block;  text-align: justify"
								 	onmouseover="show_equipment1()"
								 	onmouseout="equipment_fresh()"
								 	onclick="Choose_equipment1_button()">
										<p class="ptxt" id="Equip1_name" style="display: inline-grid;font-size: x-small"> 攻击：0 </p>
										<p class="ptxt" id="Equip1_att" style="display: none;width: 20%;font-size: x-small"> 攻击：0 </p>
										<p class="ptxt" id="Equip1_def" style="display: none;width: 20%;font-size: x-small"> 防御：0 </p>
										<p class="ptxt" id="Equip1_speed" style="display: none;width: 20%;font-size: x-small"> 速度：0 </p>
										<p class="ptxt" id="Equip1_crit" style="display: none;width: 20%;font-size: x-small"> 暴击：0 </p>
									</button>
								</div>
							</div>

							<div style="margin-right:2em; ">
								<div style=" display: inline-grid; position:static">

									<button class="button_equip_fax" type="button" id="Equip2_fax" style="border:5px solid aliceblue; background: aliceblue; display:inline-block;  text-align: justify">
										<p class="ptxt" id="Equip2_name_fax" style="display: inline-grid;font-size: x-small"> 攻击：0 </p>
									</button>

									<button class="button_equip_fail" type="button" id="Equip2" style="display:inline-block;  text-align: justify"
							 		onmouseover="show_equipment2()"
							 		onmouseout="equipment_fresh()"
							 		onclick="Choose_equipment2_button()">
										<p class="ptxt" id="Equip2_name" style="display: inline-grid;font-size: x-small"> 攻击：0 </p>
										<p class="ptxt" id="Equip2_att" style="display: none;width: 20%;font-size: x-small"> 攻击：0 </p>
										<p class="ptxt" id="Equip2_def" style="display: none;width: 20%;font-size: x-small"> 防御：0 </p>
										<p class="ptxt" id="Equip2_speed" style="display: none;width: 20%;font-size: x-small"> 速度：0 </p>
										<p class="ptxt" id="Equip2_crit" style="display: none;width: 20%;font-size: x-small"> 暴击：0 </p>
									</button>
								</div>
							</div>
						</div>

						<div style=" display:inline-table;  text-align: justify">
							<button class="button_fail" type="button" id="equipment_button"  style="display: none" value="建造护卫" onclick="get_equipment()">
								建造护卫
							</button>

							<button class="button1" type="button" id="equipment_up_button"  style="display: none" onclick="Equipment_up_button()">
								升级护卫
							</button>

						</div>

					</form>
					<HR align="left" width="100%" style="border-bottom: 2px #66ccff dashed; border-top: 2px #66ccff dotted;">
				</div>
			</div>


		<!--	中间栏的内容 		-->
			<div class="midcolumn" style="font-size: xx-small">

				<div class="card">
					<form style="text-align: justify; width: 100%; padding-bottom: 5px; border-top: 2px #66ccff; border-bottom: dotted 2px #66ccff">
						<div style="width: 70%;display:inline-grid">
							<div class="character" style=" border-color: #ffd500;display:inline-table">
								<p class="ptxt" id="Ship_name">
									普通飞船
								</p>
								<div style="display: inline-grid;width: 24%;margin-right: 2px" >
									<p class="ptxt">血量</p>
									<p class="ptxt" id="health_xx" >
										血量: 0
									</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">攻击</p>
									<p class="ptxt" id="attach_xx">
										攻击值: 0
									</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">防御</p>
									<p class="ptxt" id="defend_xx">
										防御值: 0
									</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">速度</p>
									<p class="ptxt" id="speed_xx">
										速度值: 0
									</p>
								</div>
								<div style="display: inline-grid;width: 16%;" >
									<p class="ptxt">暴击</p>
									<p class="ptxt" id="crit_xx">
										暴击值: 0
									</p>
								</div>
								<div style="background-color: white; width: 100%; text-align: center; border: #adeeaf 2px solid;border-radius: 25%">
									<HR  id="XX_health" SIZE=2 COLOR="#adeeaf" style="text-align: left; margin: 0; width: 100%">
								</div>
							</div>

							<div id="F7_meiqiu" class="character" style=" display:none">
								<p class="ptxt" id="meiqiu_name">小煤球兽</p>
								<div style="display: inline-grid;width: 24%;margin-right: 2px" >
									<p class="ptxt">血量</p>
									<p class="ptxt" id="health_meiqiu_txt">血量</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">攻击</p>
									<p class="ptxt" id="meiqiu_att">攻击</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">防御</p>
									<p class="ptxt" id="meiqiu_def">防御</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">速度</p>
									<p class="ptxt" id="meiqiu_speed">速度</p>
								</div>
								<div style="display: inline-grid;width: 16%;">
									<p class="ptxt">暴击</p>
									<p class="ptxt" id="meiqiu_crit">暴击</p>
								</div>
								<div style="background-color: white; width: 100%; text-align: center; border: #adeeaf 2px solid;border-radius: 25%">
									<HR  id="Meiqiu_health" SIZE=2 COLOR="#adeeaf" style="text-align: left; margin: 0; width: 100%">
								</div>
							</div>

							<div id="F6_maoqiu" class="character" style="display:none">
								<p class="ptxt" id="maoqiu_name">霸主毛球</p>
								<div style="display: inline-grid;width: 24%;margin-right: 2px" >
									<p class="ptxt">血量</p>
									<p class="ptxt" id="health_maoqiu" >血量: 0</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">攻击</p>
									<p class="ptxt" id="maoqiu_att">毛球攻击</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">防御</p>
									<p class="ptxt" id="maoqiu_def">毛球防御</p>
								</div>
								<div style="display: inline-grid;width: 19%" >
									<p class="ptxt">速度</p>
									<p class="ptxt" id="maoqiu_speed">毛球速度</p>
								</div>
								<div style="display: inline-grid;width: 16%" >
									<p class="ptxt">暴击</p>
									<p class="ptxt" id="maoqiu_crit">毛球暴击</p>
								</div>
								<div style="background-color: white; width: 100%; text-align: center; border: #adeeaf 2px solid;border-radius: 25%">
									<HR  id="Maoqiu_health" SIZE=2 COLOR="#adeeaf" style="text-align: left; margin: 0; width: 100%">
								</div>
							</div>

							<div id="F8_Dayboss" class="character" style=" border-color: #ff6449; display:none">
								<p class="ptxt" id="Dayboss_name">掠夺者舰队</p>
								<div style="display: inline-grid ;width: 24%; margin-right: 2px" >
									<p class="ptxt">血量</p>
									<p class="ptxt" id="Dayboss_health" >血量: 0</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">攻击</p>
									<p class="ptxt" id="Dayboss_att">boss攻击</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">防御</p>
									<p class="ptxt" id="Dayboss_def">boss防御</p>
								</div>
								<div style="display: inline-grid;width: 19%;" >
									<p class="ptxt">速度</p>
									<p class="ptxt" id="Dayboss_speed">boss速度</p>
								</div>
								<div style="display: inline-grid;width: 16%;" >
									<p class="ptxt">暴击</p>
									<p class="ptxt" id="Dayboss_crit">boss暴击</p>
								</div>
								<div style="background-color: white; width: 100%; text-align: center; border: #adeeaf 2px solid;border-radius: 25%">
									<HR  id="Dboss_health" SIZE=2 COLOR="#adeeaf" style="text-align: left; margin: 0; width: 100%">
								</div>
							</div>
						</div>

						<div style="width: 20%;min-width: 65px; max-width: 90px; display: inline-grid">
							<button class="button1" type="button" id="Tanxian" onclick="Getenemy()">
								探险
							</button>
							<button class="button2" type="button" id="fight_meiqiu" onclick="fight()">
								打他!
							</button>
							<button class="button2" type="button" id="repair_button" onclick="repair()">
								维修!
							</button>
							<button class="button1" type="button" name="daoxue_button"
									id="daoxue_fight_button" style="display: none" onclick="Daoxue_fight()">
								召唤道雪
							</button>
							<button class="button2" type="button" id="escape_button" onclick="escape()">
								撤退!
							</button>
						</div>
					</form>


					<div style="padding-top: 0px; padding-bottom: 0px; font-size: x-small; border-top: #66ccff dotted; border-bottom: #66ccff dotted;">

						<ol style="list-style:none;padding:0px;width:100%;height:220px;overflow-y: hidden" id="logol02">战斗记录：</ol>

					</div>
				</div>
			</div>


		<!--	右边栏的内容		-->
			<div class="rightcolumn" style="font-size: x-small">
				<div class="card" style="padding-top: 5px; text-align: center">
					<form action="" name="coaltotal" >
						<div id="COALtotaltxt" style=" display:inline-table; width: 30%; ">
							<p style="margin-bottom: 0em">总岚星晶矿数</p>
							<p id="COALtotal">
								总挖晶矿数量: 0
							</p>
						</div>

						<div id="spacemetaltotaltxt" style=" display:inline-table; width: 30%; ">
							<p style="margin-bottom: 0em">总星空结晶数</p>
							<p id="space_metal_total">
								星空结晶数量：
							</p>
						</div>
						<div id="skillpointtotaltxt" style=" display:inline-table; width: 30%; ">
							<p style="margin-bottom: 0em">升级点总数</p>
							<p id="skillpointtotal">
								获得的升级点：
							</p>
						</div>
					</form>

					<div>
						<div id="Meiqiutotaltxt" style=" display:inline-block; width: 30%; ">
							<form action="" id="Meiqiukillnum" style="display: none">
								<p style="margin-bottom: 0em">战胜的小怪数</p>
								<p id="Meiqiutotal">
									战胜的小怪数
								</p>
							</form>
						</div>


						<div id="Maoqiutotaltxt" style=" display:inline-block; width: 30%; ">
							<form action="" id="Maoqiukillnum" style="display: none">
								<p style="margin-bottom: 0em">战胜的毛球数</p>
								<p id="Maoqiutotal">
									战胜的毛球数
								</p>
							</form>
						</div>

						<div id="bootycoaltotaltxt" style=" display:inline-block; width: 30%;">
							<p style="margin-bottom: 0em">战利品晶矿数</p>
							<p id="bootycoaltotal">
								战利品晶矿
							</p>
						</div>



						<div id="Daybosstxt" style=" display:inline-block; width: 100%; ">
							<form action="" id="Daybosskillnum" style="width:40%;display: none">
								<p style="margin-bottom: 0em">完成赏金次数</p>
								<p id="Daybosstotal">
									完成赏金次数
								</p>
							</form>

							<form action=" " id= "record" name="game_record" style="width:40%; display: none">
									<p style="margin-bottom: 0em">战败丢人次数</p>
									<p id="defeated_record_txt" >丢人次数: 0</p>

							</form>
							<form action=" " id= "round" name="game_record" style="width:40%; display: none">
									<p style="margin-bottom: 0em">超动子数</p>
									<p id="Game_round_txt" >超动子数：0</p>

							</form>
						</div>
					</div>

				</div>


			</div>


			<div class="rightcolumn" style=" border-radius: 25px; font-size: x-small; background-color: #f1f1f1;">

					<form action="" name="Collection">
						<p style="margin-bottom:0px; padding-left: 10px;">在劳动中，你结识了:</p>
						<div style="margin-bottom: 13px; padding-left:10px; display:inline-block">
							<div id="Yumao" style=" display:inline-block; visibility: hidden">
								<p class="collect_txt">
									羽毛
								</p>
							</div>

							<div id="Xuemao" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									雪喵
								</p>
							</div>
							<div id="Changming" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									长明
								</p>
							</div>
							<div id="Huoya" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									霍娅
								</p>
							</div>
							<div id="Fengshi" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									风逝
								</p>
							</div>

							<div id="Daoxue" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									道雪
								</p>
							</div>

							<div id="Gundam" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									高达
								</p>
							</div>
							<div id="Gugu" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									咕咕
								</p>
							</div>
							<div id="Changxi" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									常曦
								</p>
							</div>
							<div id="Youzi" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									柚子
								</p>
							</div>
							<div id="Hexian" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									和弦
								</p>
							</div>
							<div id="Dis" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									dis
								</p>
							</div>
							<div id="Lvling" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									律灵
								</p>
							</div>
							<div id="Xinghuan" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									星幻
								</p>
							</div>
							<div id="Lingyu" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									泠鱼
								</p>
							</div>

							<div id="Xiaoxiao" style="display:inline-block; visibility: hidden">
								<p class="collect_txt">
									筱皛
								</p>
							</div>

						</div>
					</form>
			</div>

			<div class="rightcolumn" style="text-align: right">
				<div class="card" style="margin-bottom: 2px;">

					<button class="button2" id="Save" style=" display: inline-block"
					onclick="Clear_confirm()">
						重置游戏
					</button>

					<button class="button2" id="Export_equipment" style=" display: inline-block"
					onclick="export_equipment()">
						导出武器
					</button>

					<button class="button1" id="Import_game" style=" display: inline-block"
					onclick="import_game()">
						导入存档
					</button>

					<button class="button2" id="Export_game" style=" display: inline-block"
					onclick="export_game()">
						导出存档
					</button>

					<script>
						function Help(){
							new $Msg({title:"游戏说明",
								content:"··>收集岚星晶矿等资源用以建造飞船以及对各项功能进行升级\n"+
										"\n"+
										"·>点击挖矿可以更高效率获得岚星晶矿，但是会一定几率触发战斗。\n" +
										"\n"+
										"·>在各种工作过程中，你还会偶遇一些伙伴和事件。一起来收集伙伴吧！\n" +
										"\n"+
										"升级按键可以按住ctrl可以进行十连点"+
										"·>护卫的等级为白色<绿色<紫色<金色；最多强化+15\n" +
										"·>每小时可以挑战一次赏金任务，获得大量奖励\n" +
										"·>飞向深空后，每50级可以获得1点超动子，能够提升资源获取速度\n" +
										"·>游戏包含自动保存功能，同时可以使用导出存档来保存存档"})
						}
					</script>
				</div>

			</div>

		</div>

		<div class="footer">

			<p id="No.version" style="font-size: x-small"> 0.6.4 </p>
			<p id="updata" style="font-size: x-small">update_note</p>
			<script>
				var Version_number="版本号 v1.0"
				var update_note="更新说明：增加了转生系统，通过”飞向深空“按键进行转生，每50级获得1个超动子，超动子可以提升初始的升级点、采集速度等;对升级按键增加了按住ctrl键进行十连击的功能" ;
				document.getElementById("No.version").innerHTML = Version_number;
				document.getElementById("updata").innerHTML=update_note;
			</script>
			<div>
				<p style="font-size: x-small; display: inline-block; margin-right: 5%">特别鸣谢：星环网络 白鸽咕咕   	欢迎加入雪之屋qq590450744</p>
			<p id = "time" style="font-size: xx-small; display: inline-block;text-align: right">日期</p>
			</div>


			<script src="get_date.js"></script>
			<script>
				setInterval (function (){
					var str=$TimeFn();
					document.getElementById("time").innerHTML =str;
				}
				, 1000)
			</script>

			<script type="text/javascript">
				function export_game(){
					var len = localStorage.length;  // 获取长度
					// console.log(len) // 输出
					var arr = new Array(); // 定义数据集
					for(var i = 0; i < len; i++) {
						if(i==0){
							arr[0]={'key': "export_type", 'value':"all"}
						}else {
							// 获取key 索引从0开始
							var getKey = localStorage.key(i);
							// 获取key对应的值
							var getVal = localStorage.getItem(getKey);
							// 放进数组
							arr[i] = {
								'key': getKey,
								'value': getVal,
							}
						}

					}
					console.log(arr);
					arr = JSON.stringify(arr);
					// console.log(arr);
					var en_arr = encodeURIComponent(arr);
					// console.log(en_arr);
					en_arr = window.btoa(en_arr);
					// console.log(en_arr);
					new $Msg({title:"导出存档",
						input_content: en_arr,
						showInput: true,
						btnName:["复制", "取消"],
						confirm:(function () {
							$Copyoneline(en_arr);
							new $Msg({title:"导出存档",content:"存档已复制到剪贴板"});
							})
					})


				}

				function export_equipment(){
					if(equip1==1){
						var arr =new Array();
						var front="equip1";


					}else if(equip2==1){
						var arr = [];
						var front="equip2";
					}
					arr[0]={'key': "export_type", 'value':"equipment"}
					ls_type=eval("localStorage."+(front+"_type"));
					ls_att=eval("localStorage."+(front+"_att"));
					ls_def=eval("localStorage."+(front+"_def"));
					ls_speed=eval("localStorage."+(front+"_speed"));
					ls_crit=eval("localStorage."+(front+"_crit"));
					ls_name=eval("localStorage."+(front+"_name"));
					ls_level=eval("localStorage."+(front+"_level"));
					arr[1] = {'key': "_type", 'value':ls_type}
					arr[2] = {'key': "_att", 'value': ls_att}
					arr[3] = {'key': "_def", 'value': ls_def}
					arr[4] = {'key': "_speed", 'value': ls_speed}
					arr[5] = {'key': "_crit", 'value': ls_crit}
					arr[6] = {'key': "_name", 'value': ls_name}
					arr[7] = {'key': "_level", 'value': ls_level}
					// console.log(arr);

					// JSON格式
					arr = JSON.stringify(arr);
					// console.log(arr);

					// 编码
					var en_arr = encodeURIComponent(arr);
					// console.log(en_arr);

					// 加密
					en_arr = window.btoa(en_arr);
					new $Msg({title:"导出护卫",
						input_content: en_arr,
						content:"导出当前选定中的护卫",
						showInput: true,
						btnName:["复制", "取消"],
						confirm:(function () {
							$Copyoneline(en_arr);
							new $Msg({title:"导出装备",content:"当前选择护卫已复制到剪贴板"});
							})
					})

				}

				function import_game(){
					new $Msg({title:"导入存档",
						content:"请复制存档代码到输入框中",
						showInput: true,
						btnName:["导入", "取消"],
						confirm:(function () {
							var arr =document.getElementById("InputHTML").value;
							// console.log(arr)
							//解码存档
							var de_arr =window.atob(arr);
							de_arr = decodeURIComponent(de_arr);
							arr = JSON.parse(de_arr);
							// console.log(arr);
							var newArr = arr.slice(0);
							newArr.shift();
							// console.log(newArr);
							var storage=newArr;
							var len = storage.length;  // 获取长度

							//如果是装备存档，就补全key
							if (arr[0].value=="equipment"){
								if(equip1==1){
									var front="equip1";
									for (var i=0; i< len; i++){
										storage[i].key=front+newArr[i].key;
									}
								}else if(equip2==1){
									var front="equip2";
									for (var i=0; i< len; i++){
										storage[i].key=front+newArr[i].key;
									}
								}
							}
							// console.log(storage);
							for (var i = 0; i < len; i++){
								localStorage.setItem(storage[i].key, storage[i].value);
							}

							new $Msg({title:"导入存档",content:"存档已导入"});
							csh_();
							})
					})

				}

    		</script>

		</div>
	</div>
	</body>

</html>

